(self.webpackChunk=self.webpackChunk||[]).push([[938],{938:(e,t,s)=>{"use strict";s.r(t);var a,n,r,i,c,l,o=s(222),d=s(435),u=s(519);class h{static connectWs(){return h.webSocket$||(h.webSocket$=new d.ReplaySubject,new WebSocket(`ws://${window.location.host}${h.urlBase}/ws`).onmessage=e=>{h.webSocket$.next(JSON.parse(e.data))}),h.webSocket$}static status$(){let e=`${h.urlBase}/status`;return Y(new Request(e,{method:"GET",headers:h.headers}))}static start$(e){let t=e?`${h.urlBase}/${e}/start`:`${h.urlBase}/start`;return Y(new Request(t,{method:"POST",headers:h.headers}))}static restart$(){let e=`${h.urlBase}/restart`;return Y(new Request(e,{method:"POST",headers:h.headers}))}static stop$(e){let t=`${h.urlBase}/${e}/stop`;return Y(new Request(t,{method:"POST",headers:h.headers}))}static skeletons$(){let e=`${h.urlBase}/skeletons`;return Y(new Request(e,{method:"GET",headers:h.headers}))}static createSkeleton$(e,t){let s=`${h.urlBase}/skeletons/${e}`;return Y(new Request(s,{method:"POST",body:JSON.stringify(t),headers:h.headers}))}static install$(e){let t=`${h.urlBase}/${e}/install`;return Y(new Request(t,{method:"POST",headers:h.headers}))}}h.urlBase="/admin/backends",h.headers={},function(e){e.NOT_FOUND="FluxAppStatus.NOT_FOUND",e.SYNC="FluxAppStatus.SYNC",e.MISMATCH="FluxAppStatus.MISMATCH",e.PROCESSING="FluxAppStatus.PROCESSING",e.DONE="FluxAppStatus.DONE"}(a||(a={}));class p{constructor(){}}class f extends p{constructor({fluxStatus:e,treeStatus:t,assetStatus:s}){super(),this.fluxStatus=e,this.treeStatus=t,this.assetStatus=s}}class g extends p{}class w{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new g:new f(a)}}class x{static connectWs(){return x.webSocket$||(x.webSocket$=new d.Subject,new WebSocket(`ws://${window.location.host}${x.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);x.webSocket$.next(t),t.target&&"flux-app"==t.target&&x.package$.next(new w(t))},this.package$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.fluxApps$.next(e)}))),x.webSocket$}static status$(){this.package$.next(void 0);let e=`${x.urlBase}/status`,t=new Request(e,{method:"GET",headers:x.headers});return(0,d.combineLatest)([x.webSocket$.pipe((0,u.take)(1)),Y(t)]).pipe((0,u.map)((([e,t])=>t)))}static publish$(e){let t=`${x.urlBase}/publish/${e}`;return Y(new Request(t,{method:"POST",headers:x.headers}))}}x.urlBase="/admin/download/flux-apps",x.headers={},x.fluxApps$=new d.BehaviorSubject({}),x.package$=new d.ReplaySubject(1),function(e){e.PENDING="PENDING",e.SYNC="SYNC",e.OUTDATED="OUTDATED"}(n||(n={}));class b{static connectWs(){return b.webSocket$||(b.webSocket$=new d.ReplaySubject,new WebSocket(`ws://${window.location.host}${b.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);var s;b.webSocket$.next(t),(s=t).configurationPath&&s.userInfo&&s.users&&s.configuration&&s.remoteGatewayInfo&&s.remotesInfo&&b.environments$.next(t),function(e){return e.status&&e.components}(t)&&b.componentsUpdates$.next(t)}),b.webSocket$}static status$(){let e=`${b.urlBase}/status`;return Y(new Request(e,{method:"GET",headers:b.headers}))}static fileContent$(){let e=`${b.urlBase}/file-content`;return Y(new Request(e,{method:"GET",headers:b.headers}))}static switchConfiguration$(e){let t=`${b.urlBase}/switch-configuration`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:b.headers}))}static syncUser$(e){let t=`${b.urlBase}/sync-user`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:b.headers}))}static login$(e){let t=`${b.urlBase}/login`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:b.headers}))}static selectRemoteGateway$(e){let t=`${b.urlBase}/select-remote-gateway`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:b.headers}))}static postConfigParameters$(e){let t=`${b.urlBase}/configuration/parameters`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:b.headers}))}static triggerAvailableUpdates(){let e=`${b.urlBase}/available-updates`,t=new Request(e,{method:"GET",headers:b.headers});fetch(t).then()}static triggerSyncComponent(e){let t=`${b.urlBase}/sync-component`,s=new Request(t,{method:"POST",body:JSON.stringify(e),headers:b.headers});fetch(s).then()}}b.urlBase="/admin/environment",b.environments$=new d.ReplaySubject(1),b.componentsUpdates$=new d.ReplaySubject(1),b.headers={};class m{constructor(e){Object.assign(this,e)}}class ${static connectWs(){if($.webSocket$)return $.webSocket$;$.webSocket$=new d.ReplaySubject(1);var e=new WebSocket(`ws://${window.location.host}${$.urlBase}/ws`);return b.environments$.pipe((0,u.mergeMap)((()=>this.status$()))).subscribe(),e.onmessage=e=>{console.log("Got data",e);let t=JSON.parse(e.data);$.webSocket$.next(t),t.target&&"downloadItem"==t.target&&$.downloadItem$.next(new m(t))},this.downloadItem$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[`${t.name}#${t.version}`]:t}),{})).subscribe((e=>{this.downloadItems$.next(e)})),$.webSocket$}static status$(){let e=`${$.urlBase}/status`,t=new Request(e,{method:"GET",headers:$.headers});return $.webSocket$.pipe((0,u.take)(1),(0,u.mergeMap)((()=>Y(t))))}static getGroups$(){let e=`${$.urlBase}/groups`;return Y(new Request(e,{method:"GET",headers:$.headers}))}static getDrives$(e){let t=`${$.urlBase}/groups/${e}/drives`;return Y(new Request(t,{method:"GET",headers:$.headers}))}static packageInfo$(e){let t=`${$.urlBase}/info/${e}`;return Y(new Request(t,{method:"GET",headers:$.headers}))}static download$(e){let t=`${$.urlBase}/synchronize`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:$.headers}))}}$.urlBase="/admin/download/packages",$.groups$=new d.Subject,$.headers={},$.downloadItem$=new d.Subject,$.downloadItems$=new d.BehaviorSubject({});class S{static connectWs(){return S.webSocket$||(S.webSocket$=new d.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/frontends/ws`).onmessage=e=>{S.webSocket$.next(JSON.parse(e.data))}),S.webSocket$}static status$(){let e=`${S.urlBase}/status`;return Y(new Request(e,{method:"GET",headers:S.headers}))}static start$(e){let t=`${S.urlBase}/${e}/start`;return Y(new Request(t,{method:"POST",headers:S.headers}))}static stop$(e){let t=`${S.urlBase}/${e}/stop`;return Y(new Request(t,{method:"POST",headers:S.headers}))}static skeletons$(){let e=`${S.urlBase}/skeletons`;return Y(new Request(e,{method:"GET",headers:S.headers}))}static createSkeleton$(e,t){let s=`${S.urlBase}/skeletons/${e}`;return Y(new Request(s,{method:"POST",body:JSON.stringify(t),headers:S.headers}))}}S.urlBase="/admin/frontends",S.headers={};class v{static connectWs(){return v.webSocket$||(v.webSocket$=new d.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/local-cdn/ws`).onmessage=e=>{let t=JSON.parse(e.data);v.webSocket$.next(t),t.target&&"PackagesStatus"==t.target&&(v.packagesStatus$.next(t.cdnStatus),v.packageDetails$.next(void 0)),t.target&&"PackageDetails"==t.target&&v.packageDetails$.next(t.packageDetails)}),v.webSocket$}static status$(){let e=`${v.urlBase}/status`;return Y(new Request(e,{method:"GET",headers:v.headers}))}static getPackageDetails$(e){let t=`${v.urlBase}/packages/${e}`;return Y(new Request(t,{method:"GET",headers:v.headers}))}static deleteVersion$(e,t){let s=`${v.urlBase}/libraries/${e}/${t}`;return Y(new Request(s,{method:"DELETE",headers:v.headers}))}static deletePackage$(e){let t=`${v.urlBase}/packages/${e}`;return Y(new Request(t,{method:"DELETE",headers:v.headers}))}}v.urlBase="/admin/local-cdn",v.packagesStatus$=new d.ReplaySubject(1),v.packageDetails$=new d.ReplaySubject(1),v.headers={};class k{static connectWs(){return k.webSocket$||(k.webSocket$=new d.ReplaySubject,new WebSocket(`ws://${window.location.host}${k.urlBase}/ws`).onmessage=e=>{k.webSocket$.next(JSON.parse(e.data))}),k.webSocket$}static status$(){let e=`${k.urlBase}/status`;return Y(new Request(e,{method:"GET",headers:k.headers}))}static action$(e){let t=`${k.urlBase}/action`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:k.headers}))}static dependencies$(e){let t=`${k.urlBase}/${e}/dependencies`;return Y(new Request(t,{method:"GET",headers:k.headers}))}static watch$(e){let t=`${k.urlBase}/watch`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:k.headers}))}static skeletons$(){let e=`${k.urlBase}/skeletons`;return Y(new Request(e,{method:"GET",headers:k.headers}))}static createSkeleton$(e,t){let s=`${k.urlBase}/skeletons/${e}`;return Y(new Request(s,{method:"POST",body:JSON.stringify(t),headers:k.headers}))}static install$(e){let t=`${k.urlBase}/${e}/install`;return Y(new Request(t,{method:"POST",headers:k.headers}))}}k.urlBase="/admin/packages",k.headers={};class T{static connectWs(){return T.webSocket$||(T.webSocket$=new d.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/system/ws`).onmessage=e=>{T.webSocket$.next(JSON.parse(e.data))}),T.webSocket$}static folderContent$(e){let t=`${T.urlBase}/folder-content`,s={path:e};return Y(new Request(t,{method:"POST",body:JSON.stringify(s),headers:T.headers}))}}T.urlBase="/admin/system",T.headers={},function(e){e.NOT_FOUND="DataStatus.NOT_FOUND",e.SYNC="DataStatus.SYNC",e.MISMATCH="DataStatus.MISMATCH",e.PROCESSING="DataStatus.PROCESSING",e.DONE="DataStatus.DONE"}(r||(r={}));class y{constructor(){}}class N extends y{constructor({dataStatus:e,treeStatus:t,assetStatus:s}){super(),this.dataStatus=e,this.treeStatus=t,this.assetStatus=s}}class E extends y{}class D{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new E:new N(a)}}class I{static connectWs(){return I.webSocket$||(I.webSocket$=new d.Subject,new WebSocket(`ws://${window.location.host}${I.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);I.webSocket$.next(t),t.target&&"data"==t.target&&I.package$.next(new D(t))},this.package$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.data$.next(e)}))),I.webSocket$}static status$(){this.package$.next(void 0);let e=`${I.urlBase}/status`,t=new Request(e,{method:"GET",headers:I.headers});return(0,d.combineLatest)([I.webSocket$.pipe((0,u.take)(1)),Y(t)]).pipe((0,u.map)((([e,t])=>t)))}static publish$(e){let t=`${I.urlBase}/publish/${e}`;return Y(new Request(t,{method:"POST",headers:I.headers}))}}I.urlBase="/admin/upload/data",I.headers={},I.data$=new d.BehaviorSubject({}),I.package$=new d.ReplaySubject(1),function(e){e.NOT_FOUND="FluxAppStatus.NOT_FOUND",e.SYNC="FluxAppStatus.SYNC",e.MISMATCH="FluxAppStatus.MISMATCH",e.PROCESSING="FluxAppStatus.PROCESSING",e.DONE="FluxAppStatus.DONE"}(i||(i={}));class R{constructor(){}}class P extends R{constructor({fluxStatus:e,treeStatus:t,assetStatus:s}){super(),this.fluxStatus=e,this.treeStatus=t,this.assetStatus=s}}class O extends R{}class V{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new O:new P(a)}}class A{static connectWs(){return A.webSocket$||(A.webSocket$=new d.Subject,new WebSocket(`ws://${window.location.host}${A.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);A.webSocket$.next(t),t.target&&"flux-app"==t.target&&A.package$.next(new V(t))},this.package$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.fluxApps$.next(e)}))),A.webSocket$}static status$(){this.package$.next(void 0);let e=`${A.urlBase}/status`,t=new Request(e,{method:"GET",headers:A.headers});return(0,d.combineLatest)([A.webSocket$.pipe((0,u.take)(1)),Y(t)]).pipe((0,u.map)((([e,t])=>t)))}static publish$(e){let t=`${A.urlBase}/publish/${e}`;return Y(new Request(t,{method:"POST",headers:A.headers}))}}A.urlBase="/admin/upload/flux-apps",A.headers={},A.fluxApps$=new d.BehaviorSubject({}),A.package$=new d.ReplaySubject(1),function(e){e.NOT_FOUND="PackageStatus.NOT_FOUND",e.SYNC="PackageStatus.SYNC",e.MISMATCH="PackageStatus.MISMATCH",e.PROCESSING="PackageStatus.PROCESSING",e.DONE="PackageStatus.DONE"}(c||(c={}));class C{constructor(){}}class B extends C{constructor({cdnStatus:e,treeStatus:t,assetStatus:s}){super(),this.cdnStatus=e,this.treeStatus=t,this.assetStatus=s}}class L extends C{}class j{constructor({assetId:e,name:t,namespace:s,treeItems:a,releases:n,status:r}){this.assetId=e,this.name=t,this.namespace=s,this.treeItems=a,this.releases=n,this.status="string"==typeof r?new L:new B(r)}}class G{constructor({assetId:e,name:t,namespace:s,version:a,status:n}){this.assetId=e,this.name=t,this.namespace=s,this.version=a,this.status=n}}class F{static connectWs(){return F.webSocket$||(F.webSocket$=new d.Subject,new WebSocket(`ws://${window.location.host}${F.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);F.webSocket$.next(t),t.target&&"package"==t.target&&F.package$.next(new j(t)),t.target&&"packageVersion"==t.target&&F.packageVersion$.next(new G(t))},this.package$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.packages$.next(e)})),this.packageVersion$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[`${t.name}#${t.version}`]:t}),{})).subscribe((e=>{this.packageVersions$.next(e)}))),F.webSocket$}static status$(){this.package$.next(void 0),this.packageVersion$.next(void 0);let e=`${F.urlBase}/status`,t=new Request(e,{method:"GET",headers:F.headers});return(0,d.combineLatest)([F.webSocket$.pipe((0,u.take)(1)),Y(t)]).pipe((0,u.map)((([e,t])=>t)))}static path$(e){let t=`${F.urlBase}/${e}/path`;return Y(new Request(t,{method:"GET",headers:F.headers}))}static remotePath$(e){let t=`${F.urlBase}/${e}/remote-path`;return Y(new Request(t,{method:"GET",headers:F.headers}))}static publishLibraryVersion$(e,t){let s=`${F.urlBase}/publish/${e}/${t}`;return Y(new Request(s,{method:"POST",headers:F.headers}))}static deleteLibraryVersion$(e,t){let s=`${F.urlBase}/remove/${e}/${t}`;return Y(new Request(s,{method:"DELETE",headers:F.headers}))}static syncPackage$(e){let t=`${F.urlBase}/publish/${e}`;return Y(new Request(t,{method:"POST",headers:F.headers}))}static syncPackages$(e){let t=`${F.urlBase}/synchronize`;return Y(new Request(t,{method:"POST",body:JSON.stringify(e),headers:F.headers}))}static registerAsset(e){let t=`${F.urlBase}/register-asset/${e}`;return Y(new Request(t,{method:"POST",headers:F.headers}))}}F.urlBase="/admin/upload/packages",F.headers={},F.packages$=new d.BehaviorSubject({}),F.package$=new d.ReplaySubject(1),F.packageVersions$=new d.BehaviorSubject({}),F.packageVersion$=new d.ReplaySubject(1),function(e){e.NOT_FOUND="StoryStatus.NOT_FOUND",e.SYNC="StoryStatus.SYNC",e.MISMATCH="StoryStatus.MISMATCH",e.PROCESSING="StoryStatus.PROCESSING",e.DONE="StoryStatus.DONE"}(l||(l={}));class U{constructor(){}}class M extends U{constructor({fluxStatus:e,treeStatus:t,assetStatus:s}){super(),this.fluxStatus=e,this.treeStatus=t,this.assetStatus=s}}class _ extends U{}class q{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new _:new M(a)}}class W{static connectWs(){return W.webSocket$||(W.webSocket$=new d.Subject,new WebSocket(`ws://${window.location.host}${W.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);W.webSocket$.next(t),t.target&&"story"==t.target&&W.story$.next(new q(t))},this.story$.pipe((0,u.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.stories$.next(e)}))),W.webSocket$}static status$(){this.story$.next(void 0);let e=`${W.urlBase}/status`,t=new Request(e,{method:"GET",headers:W.headers});return(0,d.combineLatest)([W.webSocket$.pipe((0,u.take)(1)),Y(t)]).pipe((0,u.map)((([e,t])=>t)))}static publish$(e){let t=`${W.urlBase}/publish/${e}`;return Y(new Request(t,{method:"POST",headers:W.headers}))}}function Y(e,t=(e=>e)){return new d.Observable((s=>{fetch(e).then((e=>e.json())).then((e=>{s.next(t(e)),s.complete()})).catch((e=>s.error(e)))}))}W.urlBase="/admin/upload/stories",W.headers={},W.stories$=new d.BehaviorSubject({}),W.story$=new d.ReplaySubject(1);class H{static setHeaders(e){H.headers=e,h.headers=e,T.headers=e,S.headers=e,k.headers=e,b.headers=e,F.headers=e,A.headers=e,I.headers=e,$.headers=e,v.headers=e,x.headers=e,W.headers=e}}H.urlBase="/admin",H.headers={},H.system=T,H.fronts=S,H.backs=h,H.modules=k,H.environment=b,H.uploadPackages=F,H.downloadPackages=$,H.uploadFluxApps=A,H.uploadData=I,H.downloadFluxApps=x,H.localCdnPackages=v,H.uploadStory=W;var z=s(327);let J="p-2 fv-text-primary h-100 d-flex flex-column h-100";function Q(e,t){return new z.Button.View({contentView:()=>({children:[{tag:"i",class:e},{tag:"span",class:"px-2",innerText:t}]}),class:"fv-btn fv-btn-secondary mx-2"})}function K(e,t=!1){let s=new d.BehaviorSubject(t);return{class:"d-flex align-items-top fv-bg-background-alt border rounded ",style:{"font-style":"oblique",width:"fit-content"},children:[{tag:"i",class:(0,o.attr$)(s,(e=>e?"fv-hover-text-primary fv-text-focus":"fv-hover-text-focus fv-text-primary "),{wrapper:e=>e+" fas py-2 px-3 fa-info fv-pointer fv-hover-text-focus "}),onclick:e=>{s.next(!s.getValue()),e.stopPropagation()}},{class:(0,o.attr$)(s,(e=>e?"py-3 pl-1 pr-3":"")),children:[(0,o.child$)(s,(t=>t?e:{}))]}]}}var X,Z,ee,te,se,ae,ne,re,ie,ce=s(888);!function(e){e.INSTALL="INSTALL",e.BUILD="BUILD",e.TEST="TEST",e.CDN="CDN",e.SYNC="SYNC",e.SERVE="SERVE"}(X||(X={})),function(e){e.TARGET_ONLY="TARGET_ONLY",e.ALL_ABOVE="ALL_ABOVE",e.ALL_BELOW="ALL_BELOW",e.ALL="ALL"}(Z||(Z={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(ee||(ee={})),function(e){e.STARTED="STARTED",e.PREPARATION="PREPARATION",e.STATUS="STATUS",e.RUNNING="RUNNING",e.PACKAGING="PACKAGING",e.DONE="DONE"}(te||(te={})),function(e){e.INSTALLED="INSTALLED",e.NOT_INSTALLED="NOT_INSTALLED"}(se||(se={})),function(e){e.SYNC="SYNC",e.RED="RED",e.NEVER_BUILT="NEVER_BUILT",e.OUT_OF_DATE="OUT_OF_DATE",e.INDIRECT_OUT_OF_DATE="INDIRECT_OUT_OF_DATE"}(ae||(ae={})),function(e){e.GREEN="GREEN",e.OUT_OF_DATE="OUT_OF_DATE",e.INDIRECT_OUT_OF_DATE="OUT_OF_DATE",e.RED="RED",e.NO_ENTRY="NO_ENTRY"}(ne||(ne={})),function(e){e.SYNC="SYNC",e.NOT_PUBLISHED="NOT_PUBLISHED",e.OUT_OF_DATE="OUT_OF_DATE",e.CDN_ERROR="CDN_ERROR"}(re||(re={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(ie||(ie={}));class le{constructor({action:e,step:t,target:s,content:a,level:n,json:r,contextId:i}){this.contextId=void 0,this.children=[],this.action=e,this.step=t,this.target=s,this.content=a,this.level=n,this.json=r,this.contextId=i}}class oe{constructor(e){this.logs$=e,this.ongoingTasks$={}}}class de extends ce.ImmutableTree.Node{constructor({name:e,data:t}){super({id:`${Math.floor(1e6*Math.random())}`,children:de.getChildren(t)}),this.name=e,this.data=t}static getChildren(e){return null!=e&&null!=e&&"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e?(0,d.of)(Object.entries(e).map((([e,t])=>new de({name:e,data:t})))):void 0}}let ue={[te.STATUS]:"fas fa-info",[te.STARTED]:"fas fa-play",[te.PREPARATION]:"fas fa-running",[te.RUNNING]:"fas fa-running",[te.PACKAGING]:"fas fa-archive",[te.DONE]:"far fa-flag"};class he{constructor(e){this.state=e,this.class="h-25 d-flex flex-column",this.children=[this.header(),this.content()]}header(){return{tag:"hr",class:"fv-color-primary w-100"}}content(){return{class:" fv-bg-background-alt flex-grow-1 overflow-auto d-flex flex-column",children:(0,o.childrenAppendOnly$)(this.state.logs$.pipe((0,u.map)((e=>[new le(e)])),(0,u.filter)((([e])=>e.level!=ie.DEBUG&&null!=e.step))),(e=>this.messageView(e)),{sideEffects:e=>e.scrollTop=e.scrollHeight})}}messageView(e){let t=e.json?this.jsonView(e.json):{};return{class:"d-flex align-items-center my-1 "+(e.level==ie.ERROR?"fv-text-error fv-bg-on-error":"fv-text-primary"),children:[{class:"px-1 "+ue[e.step],tag:"i"},{class:"px-2",tag:"i",innerText:e.action},,{class:"px-2",tag:"i",innerText:e.target},{class:"px-2 d-flex align-items-center",children:[{class:"mx-2",innerHTML:e.content},t]}]}}jsonView(e){let t=new de({name:"data",data:e}),s=new ce.ImmutableTree.State({rootNode:t});return new ce.ImmutableTree.View({state:s,headerView:(e,t)=>{let s={innerText:t.name};return t.children?s:{class:"d-flex align-items-baseline",children:[s,{tag:"i",class:"px-2",innerText:t.data}]}}})}}var pe=s(337);function fe({startingFolder:e,originFolderIndex:t,configFileView:s,style:a}){let n=new d.BehaviorSubject(e),r=n.pipe((0,u.mergeMap)((e=>H.system.folderContent$(e))));return s=s||((e,t)=>xe(t)),{class:"fv-bg-background fv-text-primary border rounded p-4 w-100 overflow-auto",style:a||{},children:[ge(e,t),we(n,t),{class:"my-4",children:(0,o.children$)(r,(({configurations:e,files:t,folders:a})=>{let r=e.map((e=>s(n,e))),i=t.map((e=>xe(e)));return[...r,...a.map((e=>function(e,t){return{class:"fv-pointer d-flex align-items-center fv-hover-bg-background-alt",children:[{class:"fas fa-folder px-2"},{innerText:t,onclick:()=>e.next(e.getValue().concat(t))}]}}(n,e))),...i]}))}]}}function ge(e,t){return 0==t?{}:{class:"d-flex  mx-2",children:[{innerText:"origin location:"},{class:"px-2",innerText:e.slice(1,t).reduce(((e,t)=>`${e}/${t}`))}]}}function we(e,t){return{class:"d-flex",children:(0,o.children$)(e,(s=>s.slice(t).map((t=>function(e,t){let s=e.getValue().indexOf(t);return{class:"px-2 fv-pointer fv-hover-bg-background-alt border rounded mx-2",innerText:t,onclick:()=>e.next(e.getValue().slice(0,s+1))}}(e,t)))))}}function xe(e){return{class:"d-flex  align-items-center fv-text-disabled",style:{"user-select":"none"},children:[{class:"fas fa-file px-2"},{innerText:e}]}}class be extends pe.Modal.State{constructor(e){super(),this.environment=e,this.startingFolder=e.configurationPath.slice(0,-1)}}function me(e){console.log(e);let t=new be(e),s=new pe.Modal.View({state:t,contentView:$e}),a=(0,o.render)(s);document.querySelector("body").appendChild(a),t.ok$.subscribe((()=>a.remove())),t.cancel$.subscribe((()=>a.remove()))}function $e(e){return fe({startingFolder:e.startingFolder,originFolderIndex:0,configFileView:(t,s)=>function(e,t,s,a){let n=e.getValue();return{class:"fv-pointer d-flex  align-items-center fv-hover-bg-background-alt fv-text-focus",style:{"font-weight":JSON.stringify(n.concat(t))===JSON.stringify(s)?"bolder":"inherit"},children:[{class:"fas fa-file px-2"},{innerText:t}],onclick:s=>{a.next(s),Ve.switchConfiguration([...e.getValue(),t])}}}(t,s,e.environment.configurationPath,e.ok$),style:{width:"50vw",height:"50vh",overflow:"auto"}})}function Se(e){return{class:"fv-text-focus fv-pointer",innerText:e.configurationPath.slice(1).join("/"),style:{"font-size":"large"},onclick:()=>me(e)}}var ve,ke=s(313);class Te extends pe.ExpandableGroup.State{constructor(e){super("User info"),this.environment=e}}function ye(e){return{className:pe.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,o.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-users"},{innerText:"User info",class:"px-2",style:{"font-size":"large"}},{class:"fv-text-focus px-2",children:[{innerText:`Logged as ${e.environment.userInfo.name}`}]}]}}function Ne(){let e=new pe.Modal.State,t=Q("","Sign-in"),s=new d.Subject,a=new d.Subject,n=new pe.Modal.View({state:e,contentView:()=>({class:"fv-text-primary fv-bg-background-alt p-4 rounded border fv-color-primary",style:{"max-width":"500px"},children:[{class:"d-flex align-items-baseline py-2 text-center mx-auto justify-content-center",children:[{tag:"h4",class:"text-center fv-text-focus",innerText:"Synchronize with remote user"}]},{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle fa-2x px-3"},{tag:"div",innerHTML:"Provide the email adress and password of the user for which you want to synchronize the profile.  Please make sure your internet connection is turned on."}]},{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-baseline w-100",children:[{tag:"i",class:"fas fa-at px-3"},{tag:"input",type:"text",class:"flex-grow-1",onchange:e=>s.next(e.target.value)}]},{class:"d-flex align-items-baseline w-100 my-2",children:[{tag:"i",class:"fas fa-key px-3"},{tag:"input",type:"password",class:"flex-grow-1",onchange:e=>a.next(e.target.value)}]},{class:"pt-3",children:[t]}]})}),r=(0,o.render)(n);document.body.appendChild(r),e.cancel$.subscribe((()=>r.remove())),t.state.click$.pipe((0,u.withLatestFrom)((0,d.combineLatest)([s,a])),(0,u.mergeMap)((([e,[t,s]])=>H.environment.syncUser$({email:t,password:s,remoteEnvironment:"dev.platform.youwol.com"})))).subscribe((e=>{console.log(e),r.remove()}),(e=>r.remove()))}class Ee extends pe.ExpandableGroup.State{constructor(e){super("User info"),this.environment=e}}function De(e){return{className:pe.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,o.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-cog"},{innerText:"Configuration parameters",class:"px-2",style:{"font-size":"large"}}]}}class Ie extends pe.ExpandableGroup.State{constructor(e){super("Remote info"),this.gatewayInfo=e}}function Re(e){return{className:pe.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,o.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-wifi "+(e.gatewayInfo.connected?"fv-text-success":"fv-text-error")},{innerText:"Remote info",class:"px-2",style:{"font-size":"large"}},{class:"fv-text-focus px-2",children:[{innerText:e.gatewayInfo.name}]}]}}class Pe extends pe.ExpandableGroup.State{constructor(e){super("YouWol updates",Pe.isExpanded(e)),this.availableUpdates=e}static isExpanded(e){return e.status!=n.PENDING&&!e.components.reduce(((e,t)=>e&&t.latestVersion==t.localVersion),!0)}}function Oe(e){let t={[n.PENDING]:{class:"fas fa-spinner fa-spin"},[n.OUTDATED]:{class:"fas fa-exclamation fv-text-focus"},[n.SYNC]:{class:"fas fa-check fv-text-success"}};return{className:pe.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,o.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},t[e.availableUpdates.status],{innerText:e.name,class:"px-2",style:{"font-size":"large"}}]}}class Ve{constructor(){}static subscribe(){return Ve.webSocket$.pipe((0,u.take)(1),(0,u.mergeMap)((()=>H.environment.status$()))).subscribe((e=>Ve.cacheConfigurationPath(e.configurationPath)))}static switchConfiguration(e){H.environment.switchConfiguration$({path:e}).subscribe()}static getCachedConfigurationPaths(){return JSON.parse(localStorage.getItem("youwol-local-dashboard")||"{}").configurationPaths||[]}static cacheConfigurationPath(e){let t=Ve.getCachedConfigurationPaths();if(t.includes(e))return;t=t.filter((t=>t!=e)).concat([e]);let s={configurationPaths:t};localStorage.setItem("youwol-local-dashboard",JSON.stringify(s)),Ve.configurationPaths$.next(t)}syncComponent(e){H.environment.triggerSyncComponent({name:e.name,version:e.latestVersion})}}Ve.webSocket$=H.environment.connectWs(),Ve.environment$=Ve.webSocket$.pipe((0,u.filter)((e=>"Environment"==e.type))),Ve.loadingStatus$=Ve.webSocket$.pipe((0,u.filter)((e=>"LoadingStatus"==e.type))),Ve.configurationUpdated$=Ve.webSocket$.pipe((0,u.filter)((e=>"ConfigurationUpdated"==e.type))),Ve.componentsUpdates$=H.environment.componentsUpdates$,Ve.configurationPaths$=new d.BehaviorSubject(Ve.getCachedConfigurationPaths());class Ae{constructor(e){this.tag="div",this.class=J,this.state=e;let t=new oe(Ve.webSocket$.pipe((0,u.map)((e=>e))));H.environment.triggerAvailableUpdates(),this.children=[{class:"flex-grow-1",children:[(0,o.child$)(Ve.environment$,(e=>{return{class:"flex-grow-1",children:[{class:"d-flex align-items-center",children:[{class:"p-2",style:{"font-size":"large"},innerText:"configuration:"},Se(t=e),{class:"fv-pointer mx-3 fas fa-folder-open border rounded p-2 fv-hover-bg-background-alt",onclick:()=>me(t)}]}]};var t})),(0,o.child$)(Ve.environment$,(e=>{return t=e,new pe.ExpandableGroup.View({state:new Ee(t),headerView:De,contentView:e=>{return{class:"border rounded fv-color-primary p-2",children:[K({innerText:"These parameters are those declared in your configuration file. They can control behaviors of the different pipelines.\n                Refer to the configuration file for more information on the meaning of these parameters.\n                "}),(s=t.configurationParameters.parameters,{class:"my-2",children:Object.entries(s).map((([e,t])=>{let s={};return"ENUM"==t.meta.type&&(s=function(e,t){let s=t.meta.values.map((e=>new ke.Select.ItemData(e,e))),a=new ke.Select.State(s,t.value);return a.selectionId$.pipe((0,u.filter)((e=>e!=t.value)),(0,u.mergeMap)((t=>H.environment.postConfigParameters$({values:{[e]:t}})))).subscribe((()=>{})),new ke.Select.View({state:a})}(e,t)),{class:"border rounded p-2",children:[{class:"d-flex align-items-center",children:[{class:"px-2 fv-text-focus",innerText:t.name+":"},s]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle px-3"},{innerText:t.description}]}]}}))})]};var s},className:"my-2"});var t})),(0,o.child$)(Ve.environment$,(e=>function(e){let t=e.users.map((e=>new ke.Select.ItemData(e,e))),s=new d.BehaviorSubject(e.userInfo.email),a=new ke.Select.State(t,s);a.selectionId$.pipe((0,u.skip)(1),(0,u.distinctUntilChanged)(),(0,u.mergeMap)((e=>H.environment.login$({email:e})))).subscribe((()=>{}));let n=Q("fas fa-plus","sync. user");return n.state.click$.subscribe((()=>Ne())),new pe.ExpandableGroup.View({state:new Te(e),headerView:ye,contentView:t=>({class:"border rounded fv-color-primary p-2",children:[K({tag:"ul",innerText:"To better work with local YouWol it is preferable to sync your user info with your remotes account.\n                It is required when:\n                ",children:[{tag:"li",innerText:"When pushing or pulling data"}]}),{class:"d-flex align-items-center",children:[{innerText:"Current user:"},new ke.Select.View({state:a,class:"mx-2"}),n]},{children:[{tag:"ul",innerText:"Member of:",children:e.userInfo.memberOf.map((e=>({tag:"li",class:"",innerText:e})))}]}]}),className:"my-2"})}(e))),(0,o.child$)(Ve.environment$,(e=>function(e){let t=e.remotesInfo.map((({host:e})=>new ke.Select.ItemData(e,e))),s=new d.BehaviorSubject(e.remoteGatewayInfo.host),a=new ke.Select.State(t,s);return a.selectionId$.pipe((0,u.skip)(1),(0,u.distinctUntilChanged)(),(0,u.mergeMap)((e=>H.environment.selectRemoteGateway$({name:e})))).subscribe((()=>{})),new pe.ExpandableGroup.View({state:new Ie(e.remoteGatewayInfo),headerView:Re,contentView:t=>({class:"border rounded fv-color-primary p-2",children:[K({innerText:"The remote environment with which you want to synchronize your work."}),{class:"d-flex align-items-center",children:[{innerText:"Current environment:"},new ke.Select.View({state:a,class:"mx-2"})]},{tag:"ul",innerText:"Info",children:[{tag:"li",innerText:"name: "+e.remoteGatewayInfo.name},{tag:"li",innerText:"host: "+e.remoteGatewayInfo.host},{tag:"li",innerText:"connected: "+e.remoteGatewayInfo.connected}]}]}),className:"my-2"})}(e))),(0,o.child$)(Ve.componentsUpdates$,(t=>function(e,t){let s={tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Local version"},{tag:"td",innerText:"Latest version"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:t.components.map((t=>({tag:"tr",class:"fv-hover-bg-background-alt",children:[{tag:"td",innerText:t.name},{tag:"td",innerText:t.localVersion},{tag:"td",innerText:t.latestVersion},{tag:"td",children:[t.localVersion==t.latestVersion?{}:{class:"fas fa-sync fv-text-focus fv-pointer",onclick:()=>{e.syncComponent(t)}}]}]})))}]};return new pe.ExpandableGroup.View({state:new Pe(t),headerView:Oe,contentView:e=>({class:"border rounded fv-color-primary p-2",children:[K({innerText:"The updates available."}),t.status==n.PENDING?{class:"fas fa-spinner fa-spin"}:s]}),className:"my-2"})}(e,t)))]},new he(t)],this.connectedCallback=e=>{e.subscriptions.push(Ve.subscribe())}}}!function(e){e.ConfigurationGeneral="conf.general",e.ConfigurationRawFile="conf.raw-file",e.LocalEnvPackage="local.packages",e.LocalEnvFronts="local.fronts",e.LocalEnvBacks="local.backs",e.LocalEnvCDN="local.cdn",e.AssetsUploadPackages="upload.packages",e.AssetsUploadFluxApps="upload.fluxapps",e.AssetsUploadStories="upload.stories",e.AssetsDownloadFluxApps="download.fluxapps",e.AssetsUploadData="upload.data",e.AssetsUploadPackage="upload.AssetsUploadPackage",e.AssetsDownloadPackages="download.packages"}(ve||(ve={}));let Ce={[ve.ConfigurationGeneral]:{title:"General",enabled:!0},[ve.ConfigurationRawFile]:{title:"Raw file",enabled:!0},[ve.LocalEnvPackage]:{title:"Packages",enabled:!0},[ve.LocalEnvFronts]:{title:"Front Ends",enabled:!0},[ve.LocalEnvBacks]:{title:"Back Ends",enabled:!0},[ve.LocalEnvCDN]:{title:"CDN",enabled:!0},[ve.AssetsUploadPackages]:{title:"Packages",enabled:!0},[ve.AssetsUploadFluxApps]:{title:"Flux apps",enabled:!0},[ve.AssetsUploadStories]:{title:"Stories",enabled:!0},[ve.AssetsUploadData]:{title:"Data",enabled:!0},[ve.AssetsDownloadFluxApps]:{title:"Flux apps",enabled:!0},[ve.AssetsUploadData]:{title:"Data",enabled:!0},[ve.AssetsDownloadPackages]:{title:"Packages",enabled:!0}};function Be(e,t,s,a=!0){return{class:(0,o.attr$)(s,(e=>e?"fv-text-focus":""),{wrapper:e=>e+"  d-flex align-items-center fa-2x "+(a?"fv-pointer":"")}),children:[{tag:"i",class:t+" pr-3"},{tag:"h4",innerText:e,style:{"user-select":"none"}}]}}function Le(e,t){return{tag:"ul",children:(0,o.children$)(e,(e=>e.map((e=>function(e,t){let s=Ce[e].enabled;return{tag:"li",innerText:Ce[e].title,class:(0,o.attr$)(t,(t=>t==e?"fv-text-focus":s?"fv-pointer":"fv-text-background-alt")),style:{"user-select":"none"},onclick:a=>{s&&t.next(e),a.stopPropagation()}}}(e,t)))))}}function je(e,t,s,a,n=!0){return{class:"my-2 "+(n?"":"fv-text-disabled"),children:[Be(e,t,a.pipe((0,u.mergeMap)((e=>s.pipe((0,u.map)((t=>t.includes(e))))))),n),Le(s,a)]}}class Ge extends pe.Modal.State{constructor(e){super(),this.error=e}}function Fe(e){let t=new pe.ExpandableGroup.State("trace"),s=new pe.ExpandableGroup.View({state:t,headerView:pe.ExpandableGroup.defaultHeaderView,contentView:()=>({children:e.error.trace.map((e=>({innerText:e})))})});return{class:"fv-color-focus rounded fv-bg-background fv-text-primary d-flex flex-column p-4",children:[{tag:"h2",class:"text-center w-100 py-2 fv-text-error",innerText:"System error"},{class:"text-center w-100 py-2",innerText:"Details: "+e.error.details},s]}}var Ue=s(690),Me=s(444),_e=s(71);class qe extends _e.ModuleExplorer.Node{constructor({id:e,name:t,basePath:s}){super({id:e,name:t,children:qe.groups$(s),events$:qe.events$}),this.basePath=s}static groups$(e){return new Me.AssetsGatewayClient({basePath:e}).getGroups(qe.events$).pipe((0,u.map)((({groups:t})=>t.map((t=>new We({group:t,basePath:e}))))))}}qe.events$=new d.ReplaySubject;class We extends _e.ModuleExplorer.Node{constructor({group:e,basePath:t}){super({id:e.id,name:e.path,children:We.drives$(e.id,t),events$:We.events$.pipe((0,u.filter)((t=>t.targetId==e.id)))}),this.group=e,this.name=e.path,this.basePath=t}static drives$(e,t){let s=new Me.AssetsGatewayClient({basePath:t});return s.getDrives(e,We.events$).pipe((0,u.map)((({drives:e})=>e.map((({driveId:e,name:t})=>{let a=new Me.Drive(e,t,s);return new _e.ModuleExplorer.DriveNode({drive:a})})))))}}We.events$=new d.ReplaySubject;let Ye={"PackageStatus.NOT_FOUND":"far fa-circle fv-text-disabled","PackageStatus.MISMATCH":"fas fa-exclamation fv-text-focus","PackageStatus.SYNC":"fas fa-check fv-text-success","PackageStatus.PROCESSING":"fas fa-spinner fa-spin"};class He{constructor(){this.fetchDependenciesLatest$=new d.BehaviorSubject(!0),this.options$=(0,d.combineLatest)([this.fetchDependenciesLatest$]).pipe((0,u.map)((([e])=>({fetchDependenciesLatest:e})))),this.webSocket$=H.downloadPackages.connectWs(),this.logsState=new oe(this.webSocket$.pipe((0,u.map)((e=>e)))),this.selectedNode$=new d.ReplaySubject,this.queuedToDownload$=H.downloadPackages.downloadItems$.pipe((0,u.map)((e=>Object.values(e)))),this.toggled$=new d.BehaviorSubject([]),this.selectedNode$.pipe((0,u.filter)((e=>e instanceof _e.ModuleExplorer.FileNode&&e.file instanceof Me.File&&"package"==e.file.metadata.kind)),(0,u.map)((e=>e.file)),(0,u.mergeMap)((e=>H.downloadPackages.packageInfo$(e.metadata.rawId)))).subscribe()}subscribe(){return H.uploadPackages.status$().subscribe(),[H.downloadPackages.downloadItems$.subscribe((e=>{let t=Object.values(e).filter((e=>e.status!=c.SYNC)).map((e=>e.name));this.toggled$.next(t)}))]}toggle(e){let t=this.toggled$.getValue().includes(e)?this.toggled$.getValue().filter((t=>t!=e)):this.toggled$.getValue().concat([e]);this.toggled$.next(t)}synchronize(){(0,d.combineLatest)([this.queuedToDownload$,this.toggled$]).pipe((0,u.take)(1),(0,u.mergeMap)((([e,t])=>{let s=e.filter((e=>t.includes(e.name)));return H.downloadPackages.download$({packages:s})}))).subscribe()}}class ze{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.headerView(),this.contentView()]},new he(e.logsState)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}headerView(){let e=new pe.ExpandableGroup.State("options",!1),t=(e,t)=>{let s=new z.Switch.State(e);return{class:"d-flex align-items-center ",children:[{innerText:t,class:(0,o.attr$)(s.value$,(e=>e?"fv-text-focus":""),{wrapper:e=>e+" px-2"})},new z.Switch.View({state:s})]}};return new pe.ExpandableGroup.View({state:e,class:"mx-3 mb-3",headerView:pe.ExpandableGroup.defaultHeaderView,contentView:()=>({class:"d-flex w-100 justify-content-around align-items-center border rounded ",children:[t(this.state.fetchDependenciesLatest$,"fetch dependencies @ latest")]})})}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[(0,o.child$)(H.downloadPackages.status$(),(()=>function(e){let t=new ce.ImmutableTree.State({rootNode:new qe({id:"root",name:"groups",basePath:"/remote/api/assets-gateway"}),selectedNode:e.selectedNode$});return{class:"d-flex h-100 flex-column",children:[{innerText:"Remote workspace"},new ce.ImmutableTree.View({state:t,headerView:Je,connectedCallback:t=>{t.subscriptions.push(e.selectedNode$.subscribe((e=>{console.log("Node selected",e)})))},class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}(this.state)),{untilFirst:{class:"fas fa-spinner fa-spin m-auto"}}),(e=this.state,{class:"d-flex h-100 flex-column",children:[{innerText:"Download queue"},{tag:"table",class:"w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-3"},{tag:"td",innerText:"Version",class:"px-3"},{tag:"td",innerText:"Status",class:"px-3"},{tag:"td",innerText:"Queued?",class:"px-3"}]}]},{tag:"tbody",children:(0,o.childrenWithReplace$)(e.queuedToDownload$,(t=>(t=>({tag:"tr",class:"fv-pointer fv-hover-bg-background-alt ",children:[{tag:"td",innerText:t.name},{tag:"td",innerText:t.version},{tag:"td",children:[{class:Ye[t.status]}]},{tag:"input",type:"checkbox",checked:(0,o.attr$)(e.toggled$,(e=>e.includes(t.name))),onclick:()=>e.toggle(t.name)}]}))(t)),{})}]},(0,o.child$)(e.toggled$,(t=>(t=>{let s={};if(0==t.length)s={innerText:"No items selected for synchronization",class:"fv-text-focus"};else{let a=Q("fas fa-sync",`Sync. (${t.length})`);a.state.click$.subscribe((t=>e.synchronize())),s=a}return{class:"w-100",children:[{class:" border fv-color-primary"},{class:"m-3",children:[s]}]}})(t)))]})]}]};var e}}function Je(e,t){let s=[{target:e=>e instanceof _e.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof _e.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof We&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof qe||e instanceof We&&!e.id.includes("private"),icon:"fas fa-users"}];return _e.ModuleExplorer.headerView(e,t,s)}class Qe{constructor(e){this.appState=e,this.webSocket$=H.downloadFluxApps.connectWs(),this.logsState=new oe(this.webSocket$.pipe((0,u.map)((e=>e))))}subscribe(){return[]}}class Ke{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new d.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new he(e.logsState)]}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[Ze(this.state)]}]}}}class Xe extends ce.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function Ze(e){let t=new Xe({rootNode:new qe({id:"root",name:"groups",basePath:"/remote/api/assets-gateway"}),status$:e.webSocket$.pipe((0,u.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Remote workspace:"},new ce.ImmutableTree.View({state:t,headerView:et,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function et(e,t){let s=[{target:e=>e instanceof _e.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof _e.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof We&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof qe||e instanceof We&&!e.id.includes("private"),icon:"fas fa-users"}];return t instanceof _e.ModuleExplorer.FileNode&&t.file.metadata&&"flux-project"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>H.downloadFluxApps.publish$(t.id).subscribe(),class:"fas fa-cloud-download-alt fv-hover-text-focus mx-2 fv-pointer"},(0,o.child$)(e.status$.pipe((0,u.filter)((e=>e.assetId==t.id))),(({status:e})=>e==i.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:_e.ModuleExplorer.headerView(e,t,s)}class tt extends Ue.Tabs.TabData{constructor(){super(ve.AssetsDownloadPackages,Ce[ve.AssetsDownloadPackages].title),this.packagesState=new He}view(){return new ze(this.packagesState)}}class st extends Ue.Tabs.TabData{constructor(e){super(ve.AssetsDownloadFluxApps,Ce[ve.AssetsDownloadFluxApps].title),this.state=e}view(){return new Ke(this.state)}}class at extends Ue.Tabs.State{constructor(e){super([new tt,new st(new Qe(e))],e.selectedPanel$)}}class nt{constructor(e){this.selectedPanel$=e}}class rt{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=new at(e);this.children=[new Ue.Tabs.View({class:"d-flex flex-column h-100",state:t,headerView:it,contentView:(e,t)=>t.view()})],this.connectedCallback=e=>{}}}function it(e,t){return{innerText:t.name,class:"px-2"}}function ct(e){let t=new pe.ExpandableGroup.State("Explorer",!1);return new pe.ExpandableGroup.View({state:t,headerView:ot,contentView:t=>({class:"my-2 h-100 w-100",style:{"white-space":"nowrap"},children:[{class:"d-flex justify-content-around",children:[{innerText:"Local reference"},{innerText:"Remote reference"}]},{class:"d-flex justify-content-around",children:[{class:"w-50 d-flex justify-content-center",children:[(0,o.child$)(H.uploadPackages.path$(e.treeItems[0].itemId),(e=>ut(e)))]},{class:"w-50  d-flex justify-content-center",children:[(0,o.child$)(H.environment.environments$.pipe((0,u.mergeMap)((()=>H.uploadPackages.remotePath$(e.assetId)))),(e=>e.group&&e.drive&&e.folders?ut(e):{class:"fas fa-times fv-text-error"}),{untilFirst:{class:"fas fa-spinner fa-spin fv-text-primary mx-auto my-auto"}})]}]}]}),class:"mb-3"})}function lt(e){let t=new pe.ExpandableGroup.State("CDN versions",!0);return new pe.ExpandableGroup.View({state:t,headerView:ot,contentView:()=>({class:"d-flex justify-content-center",children:[ht(e)]}),class:"mb-3"})}function ot(e){return pe.ExpandableGroup.defaultHeaderView(e)}function dt(e){return{class:"d-flex justify-content-center align-items-center ",children:[{tag:"h3",class:"text-center my-2",innerText:e.name}]}}function ut({group:e,drive:t,folders:s}){return{class:"border rounded fv-color-primary p-2 mx-2",style:{width:"fit-content"},children:[{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-users px-2"},{innerText:e}]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-hdd px-2"},{innerText:t.name}]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-folder px-2"},{innerText:s.reduce(((e,t)=>e+" / "+t.name),"")}]}]}}function ht(e){let t=H.uploadPackages.packageVersions$.pipe((0,u.map)((e=>Object.values(e))),(0,u.map)((t=>t.filter((({name:t})=>t==e.name)))));return{tag:"table",class:"fv-color-primary text-center my-3",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Local versions",class:"px-3"},{tag:"td",innerText:"Published versions",class:"px-3"},{tag:"td",innerText:"",class:"px-3"},{tag:"td",innerText:"",class:"px-3"}]}]},(0,o.child$)(t,(t=>({tag:"tbody",children:t.map((({assetId:t,name:s,version:a,status:n})=>({tag:"tr",class:"fv-hover-bg-background-alt",children:[{tag:"td",innerText:a,class:"px-3"},{tag:"td",class:"px-3",children:[{tag:"i",class:Ye[n]}]},ft(e,a),gt(e,a)]})))})))]}}function pt(e,t){return{tag:"td",class:"mx-2",children:[{tag:"i",class:`fas ${t} fv-hover-text-focus p-2 fv-pointer`,onclick:e},{}]}}function ft(e,t){return pt((()=>H.uploadPackages.publishLibraryVersion$(e.assetId,t).subscribe()),"fa-cloud-upload-alt")}function gt(e,t){return pt((()=>{confirm(`Are you sure you want to remove ${e.name}/${t} from local & deployed CDN`)&&H.uploadPackages.deleteLibraryVersion$(e.assetId,t).pipe((0,u.mergeMap)((()=>H.uploadPackages.status$()))).subscribe()}),"fa-trash fv-text-error ml-4")}function wt(e,t,s){return{tag:"table",class:"w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-3"},{tag:"td",innerText:"Version",class:"px-3"},{tag:"td",innerText:"Status",class:"px-3"},{tag:"td",innerText:"Queued?",class:"px-3"}]}]},{tag:"tbody",children:e.map((({assetId:e,name:a,version:n,status:r})=>{let i="fv-pointer fv-hover-bg-background-alt ";return(!t.showSynced&&r==c.SYNC||!t.showNext&&n.includes("-next"))&&(i+="d-none"),{tag:"tr",class:i,children:[{tag:"td",innerText:a},{tag:"td",innerText:n},{tag:"td",children:[{class:Ye[r]}]},{tag:"input",type:"checkbox",checked:(0,o.attr$)(s.isToggled$(e,n),(e=>e)),onclick:()=>s.toggleSync(e,n)}]}}))}]}}function xt(e,t){let s="";return e.status instanceof L&&(s="fas fa-spinner fa-spin"),e.status instanceof B&&(s=Ye[e.status.cdnStatus]),{tag:"td",children:[{class:s}]}}function bt(e,t){let s="",a={};return e.status instanceof L&&(s="fas fa-spinner fa-spin"),e.status instanceof B&&(s=Ye[e.status.treeStatus],e.status.treeStatus!=c.SYNC&&(a={class:"fas fa-cloud-upload-alt fv-hover-text-focus fv-pointer",onclick:t=>{H.uploadPackages.registerAsset(e.assetId).subscribe(),t.stopPropagation()}})),{tag:"td",class:"d-flex align-items-center justify-content-around my-auto",children:[{class:s},a]}}class mt{constructor(e){this.appState=e,this.showSynced$=new d.BehaviorSubject(!1),this.showNext$=new d.BehaviorSubject(!1),this.options$=(0,d.combineLatest)([this.showSynced$,this.showNext$]).pipe((0,u.map)((([e,t])=>({showSynced:e,showNext:t})))),this.webSocket$=H.uploadPackages.connectWs(),this.syncQueued$=new d.BehaviorSubject(new Set),this.underSynchronization$=new d.BehaviorSubject(new Set),this.logsState=new oe(this.webSocket$.pipe((0,u.map)((e=>e))))}subscribe(){return H.uploadPackages.status$().subscribe(),[]}toggleSync(e,t){let s=e+"#"+t,a=this.syncQueued$.getValue();a.has(s)?a.delete(s):a.add(s),this.syncQueued$.next(a)}isToggled$(e,t){let s=e+"#"+t;return this.syncQueued$.pipe((0,u.map)((e=>e.has(s))))}synchronize(){let e={assetIds:Array.from(this.syncQueued$.getValue()).map((e=>({assetId:e.split("#")[0],version:e.split("#")[1]})))};H.uploadPackages.syncPackages$(e).subscribe()}}class $t{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new d.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.headerView(),this.contentView()]},new he(e.logsState)],this.selected$.subscribe((e=>{console.log(e),this.state.appState.addTabUpload(e)}))}headerView(){let e=new pe.ExpandableGroup.State("options",!1),t=(e,t)=>{let s=new z.Switch.State(e);return{class:"d-flex align-items-center ",children:[{innerText:t,class:(0,o.attr$)(s.value$,(e=>e?"fv-text-focus":""),{wrapper:e=>e+" px-2"})},new z.Switch.View({state:s})]}};return new pe.ExpandableGroup.View({state:e,class:"mx-3 mb-3",headerView:pe.ExpandableGroup.defaultHeaderView,contentView:()=>({class:"d-flex w-100 justify-content-around align-items-center border rounded ",children:[t(this.state.showSynced$,"display synced items"),t(this.state.showNext$,"display '-next' items")]})})}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[(0,o.child$)((0,d.combineLatest)([H.uploadPackages.packages$,this.state.options$]),(([e,t])=>function(e,t,s,a){return{class:"h-100 d-flex flex-column",children:[{class:"overflow-auto fv-color-primary border",children:[{tag:"table",class:" w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-3"},{tag:"td",innerText:"CDN",class:"px-3"},{tag:"td",innerText:"Asset",class:"px-3"}]}]},{tag:"tbody",children:e.map((e=>{let a="fv-pointer fv-hover-bg-background-alt ";return e.status instanceof B&&!t.showSynced&&e.status.cdnStatus==c.SYNC&&e.status.treeStatus==c.SYNC&&(a+="d-none"),{tag:"tr",class:a,children:[{tag:"td",innerText:e.name,class:"px-3"},xt(e),bt(e)],onclick:()=>s.next(e)}}))}]}]}]}}(Object.values(e),t,this.selected$,this.state))),(0,o.child$)((0,d.combineLatest)([H.uploadPackages.packageVersions$,this.state.options$]),(([e,t])=>function(e,t,s){return{class:"d-flex flex-column border fv-color-primary",style:{height:"fit-content","max-height":"100%"},children:[{class:"overflow-auto",children:[wt(e,t,s)]},{class:"d-flex align-items-baseline",children:[(0,o.child$)(s.syncQueued$,(e=>function(e,t){let s={};if(0==e.size)s={innerText:"No items selected for synchronization",class:"fv-text-focus"};else{let a=Q("fas fa-sync",`Sync. (${e.size})`);a.state.click$.subscribe((e=>t.synchronize())),s=a}return{class:"w-100",children:[{class:" border fv-color-primary"},{class:"m-3",children:[s]}]}}(e,s)))]}]}}(Object.values(e),t,this.state)))]}]}}}class St{constructor(e){this.appState=e,this.webSocket$=H.uploadFluxApps.connectWs(),this.logsState=new oe(this.webSocket$.pipe((0,u.map)((e=>e))))}subscribe(){return[]}}class vt{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new d.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new he(e.logsState)],this.selected$.subscribe((e=>{console.log(e),this.state.appState.addTabUpload(e)}))}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[Tt(this.state)]}]}}}class kt extends ce.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function Tt(e){let t=new kt({rootNode:new qe({id:"root",name:"groups",basePath:"/api/assets-gateway"}),status$:e.webSocket$.pipe((0,u.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Local workspace:"},new ce.ImmutableTree.View({state:t,headerView:yt,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function yt(e,t){let s=[{target:e=>e instanceof _e.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof _e.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof We&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof qe||e instanceof We&&!e.id.includes("private"),icon:"fas fa-users"}];return t instanceof _e.ModuleExplorer.FileNode&&t.file.metadata&&"flux-project"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>H.uploadFluxApps.publish$(t.id).subscribe(),class:"fas fa-cloud-upload-alt fv-hover-text-focus mx-2 fv-pointer"},(0,o.child$)(e.status$.pipe((0,u.filter)((e=>e.assetId==t.id))),(({status:e})=>e==i.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:_e.ModuleExplorer.headerView(e,t,s)}class Nt{constructor(e){this.appState=e,this.webSocket$=H.uploadStory.connectWs(),this.logsState=new oe(this.webSocket$.pipe((0,u.map)((e=>e))))}subscribe(){return[]}}class Et{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new d.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new he(e.logsState)],this.selected$.subscribe((e=>{console.log(e),this.state.appState.addTabUpload(e)}))}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[It(this.state)]}]}}}class Dt extends ce.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function It(e){let t=new Dt({rootNode:new qe({id:"root",name:"groups",basePath:"/api/assets-gateway"}),status$:e.webSocket$.pipe((0,u.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Local workspace:"},new ce.ImmutableTree.View({state:t,headerView:Rt,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function Rt(e,t){let s=[{target:e=>e instanceof We&&e.id.includes("private"),icon:"fas fa-user fv-pointer"},{target:e=>e instanceof qe||e instanceof We&&!e.id.includes("private"),icon:"fas fa-users  fv-pointer"},{target:e=>!0,classes:"d-flex align-items-center  fv-pointer"}];return t instanceof _e.ModuleExplorer.FileNode&&t.file.metadata&&"story"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>H.uploadStory.publish$(t.id).subscribe(),class:"fas fa-cloud-upload-alt fv-hover-text-focus mx-2 fv-pointer"},(0,o.child$)(e.status$.pipe((0,u.filter)((e=>e.assetId==t.id))),(({status:e})=>e==l.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:_e.ModuleExplorer.headerView(e,t,s)}class Pt{constructor(e){this.appState=e,this.webSocket$=H.uploadData.connectWs(),this.logsState=new oe(this.webSocket$.pipe((0,u.map)((e=>e))))}subscribe(){return[]}}class Ot{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new d.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new he(e.logsState)]}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[At(this.state)]}]}}}class Vt extends ce.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function At(e){let t=new Vt({rootNode:new qe({id:"root",name:"groups",basePath:"/api/assets-gateway"}),status$:e.webSocket$.pipe((0,u.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Local workspace to import data:"},new ce.ImmutableTree.View({state:t,headerView:Ct,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function Ct(e,t){let s=[{target:e=>e instanceof _e.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof _e.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof We&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof qe||e instanceof We&&!e.id.includes("private"),icon:"fas fa-users"}];return t instanceof _e.ModuleExplorer.FileNode&&t.file.metadata&&"data"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>H.uploadData.publish$(t.id).subscribe(),class:"fas fa-cloud-upload-alt fv-hover-text-focus mx-2 fv-pointer"},(0,o.child$)(e.status$.pipe((0,u.filter)((e=>e.assetId==t.id))),(({status:e})=>e==i.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:_e.ModuleExplorer.headerView(e,t,s)}class Bt extends Ue.Tabs.TabData{constructor(e){super(ve.AssetsUploadPackages,"Packages"),this.packagesState=e}view(){return new $t(this.packagesState)}}class Lt extends Ue.Tabs.TabData{constructor(e,t){super(e.name,e.name),this.library=e,this.packagesState=t}view(){return e=this.library,t=this.packagesState,{class:"h-100 d-flex flex-column w-100 fv-bg-background-alt fv-color-primary",children:[{class:"h-100 d-flex flex-column fv-bg-background p-3  overflow-auto",children:[dt(e),{tag:"hr",class:"w-100 fv-color-primary"},ct(e),lt(e)]},new he(t.logsState)]};var e,t}}class jt extends Ue.Tabs.TabData{constructor(e){super(ve.AssetsUploadFluxApps,"Flux Apps"),this.state=e}view(){return new vt(this.state)}}class Gt extends Ue.Tabs.TabData{constructor(e){super(ve.AssetsUploadStories,"Stories"),this.state=e}view(){return new Et(this.state)}}class Ft extends Ue.Tabs.TabData{constructor(e){super(ve.AssetsUploadData,"Data"),this.state=e}view(){return new Ot(this.state)}}class Ut{constructor(e){this.selectedPanel$=e,this.selectedTab$=new d.BehaviorSubject("packages"),this.packagesState=new mt(this),this.fluxAppsState=new St(this),this.dataAssetState=new Pt(this),this.storiesState=new Nt(this),e.subscribe((e=>{this.selectedTab$.next(e)})),this.tabsData$=new d.BehaviorSubject([new Bt(this.packagesState),new jt(this.fluxAppsState),new Gt(this.storiesState),new Ft(this.dataAssetState)])}addTabUpload(e){this.tabsData$.getValue().find((t=>t instanceof Lt&&t.id==e.name))||(this.tabsData$.next([...this.tabsData$.getValue(),new Lt(e,this.packagesState)]),this.selectedTab$.next(e.name))}removeTabUpload(e){this.selectedTab$.getValue()==e&&this.selectedTab$.next(this.tabsData$.getValue()[0].id),this.tabsData$.next(this.tabsData$.getValue().filter((t=>t.name!=e)))}}class Mt extends Ue.Tabs.State{constructor(e){super(e.tabsData$,e.selectedTab$),this.assetsState=e}}class _t{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=new Mt(e);this.children=[new Ue.Tabs.View({class:"d-flex flex-column h-100",state:t,headerView:qt,contentView:(e,t)=>t.view()})],this.connectedCallback=t=>{t.ownSubscriptions(...e.packagesState.subscribe())}}}function qt(e,t){return t instanceof Bt||t instanceof jt||t instanceof Ft||t instanceof Gt?{innerText:t.name,class:"px-2"}:t instanceof Lt?{class:"d-flex align-items-center px-2",children:[{innerText:t.name,class:"px-2"},{class:"fas fa-times fv-pointer p-1 ",onclick:s=>{e.assetsState.removeTabUpload(t.name),s.stopPropagation()}}]}:void 0}class Wt{constructor(){}}class Yt{constructor(){this.tag="div",this.class=J;let e=new oe(Ve.webSocket$);this.children=[{class:"d-flex flex-column flex-grow-1 w-100 overflow-auto",style:{height:"0"},children:[K({innerHTML:"This is a readonly preview of your current configuration file.\nYou can get arguments completion, type checkings, and more when editing this file with <a href='https://www.jetbrains.com/fr-fr/pycharm/'>pycharm</a> and the plugin <a href='https://pydantic-docs.helpmanual.io/pycharm_plugin/'> pydantic </a>."}),(0,o.child$)(H.environment.fileContent$(),(({content:e})=>({id:"codeMirror",class:"flex-grow-1 w-100 py-1",style:{height:"0"},connectedCallback:t=>{let s=document.getElementById("codeMirror"),a={value:e,mode:"python",theme:"blackboard",lineNumbers:!0};window.CodeMirror(s,a).setSize("100%","100%")}})))]},new he(e)],this.connectedCallback=e=>{}}}let Ht={[ve.ConfigurationGeneral]:"General",[ve.ConfigurationRawFile]:"Raw file"};class zt{constructor(e){this.selectedPanel$=e,this.logMessages$=new d.Subject,this.generalState=new Ve,this.packageState=new Wt}}class Jt extends Ue.Tabs.TabData{constructor(e){super(ve.ConfigurationGeneral,Ht[ve.ConfigurationGeneral]),this.generalState=e}view(){return new Ae(this.generalState)}}class Qt extends Ue.Tabs.TabData{constructor(e){super(ve.ConfigurationRawFile,Ht[ve.ConfigurationRawFile]),this.generalState=e}view(){return new Yt}}class Kt{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1 w-25";let t=[new Jt(e.generalState),new Qt(e.generalState)];this.children=[new Ue.Tabs.View({class:"d-flex flex-column h-100",state:new Ue.Tabs.State(t,e.selectedPanel$),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}class Xt extends ke.Select.ItemData{constructor(e){super(e.name,e.name),this.data=e}}function Zt(e,t,s){let a=t.map((e=>new Xt(e))),n=new ke.Select.State(a,a[0].id),r=new pe.Modal.State,i=Q("","Create"),c=new d.ReplaySubject(1),l=new pe.Modal.View({state:r,contentView:()=>({class:"fv-text-primary fv-bg-background-alt p-4 rounded border fv-color-primary",style:{"max-width":"75%"},children:[{class:"d-flex align-items-baseline py-2 text-center mx-auto justify-content-center",children:[{tag:"h3",class:"text-center fv-text-focus",innerText:e},new ke.Select.View({state:n,class:"mx-2",style:{"font-size":"x-large"}})]},(0,o.child$)(n.selection$,(e=>function(e,t){let s=e.data.parameters.map((e=>{let t=new d.ReplaySubject(1);return null!=e.defaultValue&&t.next({id:e.id,value:e.defaultValue}),t}));return{children:[(a=e.data.description,{children:[{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle fa-2x px-3"},{tag:"div",innerHTML:a}]},{tag:"hr",class:"fv-color-primary"}]}),{children:e.data.parameters.map(((e,t)=>function(e,t){let s=new d.BehaviorSubject(!1),a={string:{class:"ml-2",tag:"input",placeholder:e.placeholder,oninput:s=>t.next({id:e.id,value:s.target.value})},text:{tag:"textarea",class:"ml-2 w-100 flex-grow-1",placeholder:e.placeholder,oninput:s=>t.next({id:e.id,value:s.target.value})}};return{children:[{class:"d-flex align-items-center my-3",children:[{class:e.required?"fv-text-focus":"",innerText:e.displayName},{class:"fv-text-focus",innerText:e.required?"*":""},{class:(0,o.attr$)(s,(e=>e?"fv-text-focus":""),{wrapper:e=>"i fas fa-info fv-pointer mx-2 fv-hover-text-focus "+e}),onclick:()=>s.next(!s.getValue())},{...a[e.type],...e.defaultValue?{value:e.defaultValue}:{}}]},{class:(0,o.attr$)(s,(e=>e?"d-block":"d-none")),innerText:e.description}]}}(e,s[t])))}],connectedCallback:e=>{0!=s.length?e.subscriptions.push((0,d.combineLatest)(s).pipe((0,u.map)((e=>e.reduce(((e,t)=>({...e,[t.id]:t.value})),{})))).subscribe((e=>{t.next(e)}))):t.next({parameters:{}})}};var a}(e,c))),{tag:"hr",class:"fv-color-primary"},(0,o.child$)(c,(e=>i))]})}),h=(0,o.render)(l);document.body.appendChild(h),r.cancel$.subscribe((()=>h.remove())),i.state.click$.pipe((0,u.mergeMap)((()=>c)),(0,u.mergeMap)((e=>s.createSkeleton$(n.selectionId$.getValue(),{parameters:e})))).subscribe((e=>{h.remove()}))}class es{constructor(){this.status$=new d.ReplaySubject(1),this.webSocket$=H.fronts.connectWs()}subscribe(){return[this.webSocket$.pipe((0,u.filter)((({type:e})=>"Status"==e))).subscribe((({status:e})=>{this.status$.next(e)})),(0,d.combineLatest)([this.webSocket$.pipe((0,u.take)(1)),Ve.configurationUpdated$]).pipe((0,u.mergeMap)((()=>H.fronts.status$()))).subscribe((e=>{this.status$.next(e.status)}))]}}class ts{constructor(e){this.tag="div",this.class=J,this.state=e;let t=new oe(this.state.webSocket$);this.children=[{tag:"h3",class:"d-flex",children:[(0,o.child$)(e.status$,(()=>({children:[this.newFrontBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,o.child$)(e.status$,(e=>this.contentView(e))),new he(t)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}newFrontBttn(){let e=Q("fas fa-plus","new front-end");return e.state.click$.pipe((0,u.mergeMap)((()=>H.fronts.skeletons$()))).subscribe((({skeletons:e})=>{Zt("New frontend",e,H.fronts)})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.tableView(e)]}}tableView(e){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"url"},{tag:"td",innerText:"Dev server"},{tag:"td",innerText:"Health"}]}]},{tag:"tbody",children:e.map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt",children:[(t=e,{tag:"td",innerText:t.name,style:{"font-family":"cursive","font-size":"large"}}),ss(e),ns(this.state,e),as(e)]};var t}))}]}}}function ss(e){return{tag:"td",children:[{tag:"a",href:e.url,innerText:e.url}]}}function as(e){return{tag:"td",class:e?"fv-text-success":"fv-text-error",children:[{tag:"i",class:e?"fas fa-check px-2":"fas fa-times px-2",onclick}]}}function ns(e,t){if(null==t.devServer)return{};let s=e.webSocket$.pipe((0,u.filter)((e=>e.target==t.name&&e.action==X.SERVE)),(0,u.filter)((({step:e})=>[te.STARTED,te.DONE].includes(e)))),a=new d.ReplaySubject;return s.subscribe((e=>{a.next(e)})),a.next(t.devServer?{step:te.STARTED}:{step:te.DONE}),{tag:"td",children:[{children:[(0,o.child$)(a,(({step:e})=>({tag:"i",class:"fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus"+(e==te.STARTED?" fas fa-stop ":" fas fa-play "),onclick:()=>e==te.STARTED?H.fronts.stop$(t.name).subscribe((()=>{})):H.fronts.start$(t.name).subscribe((()=>{}))})))]}]}}class rs{constructor(){this.highlighted$=new d.ReplaySubject(1),this.autoWatched$=new d.BehaviorSubject([]),this.dependenciesRequest$=new d.Subject,this.webSocket$=H.modules.connectWs()}subscribe(){return[(0,d.combineLatest)([this.webSocket$.pipe((0,u.take)(1)),Ve.configurationUpdated$]).pipe((0,u.mergeMap)((()=>H.modules.status$()))).subscribe((e=>{rs.status$.next(e)})),this.dependenciesRequest$.pipe((0,u.debounceTime)(250),(0,u.switchMap)((({assetId:e,direction:t})=>H.modules.dependencies$(e).pipe((0,u.map)((e=>({deps:e,direction:t}))))))).subscribe((({deps:e,direction:t})=>{"up"==t?this.highlighted$.next(e.belowDependencies):this.highlighted$.next(e.aboveDependencies)}))]}toggleWatch(e){let t=this.autoWatched$.getValue();t=t.includes(e)?t.filter((t=>t!=e)):t.concat([e]),this.autoWatched$.next(t),H.modules.watch$({libraries:t}).subscribe()}}rs.status$=new d.ReplaySubject(1);class is{constructor(e){this.tag="div",this.class=J,this.state=e;let t=new oe(this.state.webSocket$.pipe((0,u.map)((e=>e))));this.children=[{tag:"h3",class:"d-flex",children:[(0,o.child$)(rs.status$,(()=>({children:[this.syncAllBttn(),this.newPackageBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,o.child$)(rs.status$.pipe((0,u.map)((e=>e.status))),(e=>this.contentView(e))),new he(t)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}syncAllBttn(){let e=Q("fas fa-sync","Sync. all");return e.state.click$.pipe((0,u.mergeMap)((()=>H.modules.action$({action:"SYNC",targetName:"",scope:"ALL"})))).subscribe((e=>{rs.status$.next(e)})),e}newPackageBttn(){let e=Q("fas fa-plus","new package");return e.state.click$.pipe((0,u.mergeMap)((()=>H.modules.skeletons$()))).subscribe((({skeletons:e})=>{Zt("New package",e,H.modules)})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.installQueueView(e),this.pipelinesTableView(e)]}}installQueueView(e){return 0==e.filter((e=>"NOT_INSTALLED"==e.installStatus)).length?{}:{class:"overflow-auto",children:[{tag:"h3",innerText:"List of packages to install"},K({innerText:"Following packages have not been installed yet. \n                    Installation step usually install required dependencies and initialize the asset properly. \n                    Internet connection is usually required here."}),{tag:"table",class:"fv-color-primary mx-auto text-center my-2",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:e.filter((e=>"NOT_INSTALLED"==e.installStatus)).map((e=>({tag:"tr",children:[os(e),us(this.state,e)]})))}]}]}}pipelinesTableView(e){return e.filter((e=>"INSTALLED"==e.installStatus)),{class:"overflow-auto",children:[{tag:"h3",innerText:"Pipelines status"},{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Version"},{tag:"td",innerText:"Watch"},{tag:"td",innerText:"Actions"},{tag:"td",innerText:"Build Status"},{tag:"td",innerText:"Test Status"},{tag:"td",innerText:"CDN Status"}]}]},{tag:"tbody",children:e.filter((e=>"INSTALLED"==e.installStatus)).map((e=>({tag:"tr",class:(0,o.attr$)(this.state.highlighted$,(t=>t.includes(e.name)?"fv-bg-background-alt":""),{wrapper:e=>e+" fv-hover-bg-background-alt",untilFirst:"fv-hover-bg-background-alt"}),children:[os(e),ds(e),hs(this.state,e),ps(this.state,e),ws(this.state,e),xs(this.state,e),bs(this.state,e)]})))}]}]}}}let cs="fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus",ls={NEVER_BUILT:{color:"fv-text-focus ",icon:"fas fa-sync "+cs,text:"never built"},NOT_PUBLISHED:{color:"fv-text-focus ",icon:"fas fa-sync "+cs,text:""},GREEN:{color:"fv-text-success ",icon:"fas fa-check ",text:""},RED:{color:"fv-text-error ",icon:"fas fa-sync "+cs,text:""},CDN_ERROR:{color:"fv-text-error ",icon:"fas fa-times ",text:""},OUT_OF_DATE:{color:"fv-text-focus ",icon:"fas fa-sync "+cs,text:""},INDIRECT_OUT_OF_DATE:{color:"fv-text-focus ",icon:"fas fa-sync "+cs,text:"(indirect)"},NO_ENTRY:{color:"fv-text-focus ",icon:"fas fa-sync "+cs,text:""},SYNC:{color:"fv-text-success ",icon:"fas fa-check "+cs,text:""}};function os(e){return e.documentation?{tag:"td",style:{"font-family":"cursive","font-size":"large"},children:[{tag:"a",href:e.documentation,innerText:e.name}]}:{tag:"td",innerText:e.name,style:{"font-family":"cursive","font-size":"large"}}}function ds(e){return{tag:"td",innerText:e.version}}function us(e,t){let s=e.webSocket$.pipe((0,u.filter)((e=>e.target==t.name&&e.action==X.INSTALL))),a=Q("","Install");return a.state.click$.pipe((0,u.mergeMap)((()=>H.modules.install$(t.assetId)))).subscribe((()=>console.log("install done"))),{class:"d-flex align-items-center",children:[(0,o.child$)(a.state.click$,(()=>({})),{untilFirst:a}),{tag:"i",class:(0,o.attr$)(s.pipe((0,u.filter)((({step:e})=>[te.STARTED,te.DONE].includes(e)))),(e=>e.step==te.STARTED?"fas fa-spinner fa-spin p-3":""))}]}}function hs(e,t){return{tag:"td",class:(0,o.attr$)(e.autoWatched$,(e=>e.includes(t.name)?"fas fa-satellite-dish fv-text-focus ":"fas fa-satellite-dish "),{wrapper:e=>e+cs}),onclick:()=>e.toggleWatch(t.name)}}function ps(e,t){return{tag:"td",children:[{tag:"i",class:"far fa-arrow-alt-circle-right "+cs,onclick:()=>fs(0,{action:X.SYNC,targetName:t.name,scope:Z.TARGET_ONLY})},{tag:"i",class:"far fa-arrow-alt-circle-up "+cs,onclick:()=>fs(0,{action:X.SYNC,targetName:t.name,scope:Z.ALL_ABOVE}),onmouseover:()=>{e.dependenciesRequest$.next({assetId:t.assetId,direction:"up"})},onmouseout:()=>e.highlighted$.next([])},{tag:"i",class:"far fa-arrow-alt-circle-down "+cs,onclick:()=>fs(0,{action:X.SYNC,targetName:t.name,scope:Z.ALL_BELOW}),onmouseover:s=>{e.dependenciesRequest$.next({assetId:t.assetId,direction:"down"})},onmouseout:()=>e.highlighted$.next([])}]}}function fs(e,t){H.modules.action$(t).subscribe((e=>{}))}function gs(e,t,s){let a=e.webSocket$.pipe((0,u.filter)((e=>e.target==t&&e.action==s))),n=new d.ReplaySubject;return{tag:"td",class:(0,o.attr$)(n,(({color:e})=>e)),children:[{tag:"i",innerText:(0,o.attr$)(n,(({text:e})=>e))},{tag:"i",class:(0,o.attr$)(n,(({icon:e})=>e)),onclick:()=>fs(0,{action:s,targetName:t,scope:Z.TARGET_ONLY})},{tag:"i",class:(0,o.attr$)(a.pipe((0,u.filter)((({step:e})=>[te.STARTED,te.DONE].includes(e)))),(e=>e.step==te.STARTED?"fas fa-spinner fa-spin":""))}],connectedCallback:e=>{e.subscriptions.push(a.pipe((0,u.filter)((({step:e,content:t})=>e==te.STATUS&&null!=ls[t])),(0,u.map)((({content:e})=>ls[e]))).subscribe((e=>{n.next(e)})))}}}function ws(e,t){return gs(e,t.name,X.BUILD)}function xs(e,t){return gs(e,t.name,X.TEST)}function bs(e,t){return gs(e,t.name,X.CDN)}function ms(e,t,s){let a=e.pipe((0,u.filter)((e=>e.target==t.name&&e.action==X.INSTALL))),n=Q("","Install");return n.state.click$.pipe((0,u.mergeMap)((()=>s.install$(t.assetId)))).subscribe((()=>console.log("install done"))),{class:"d-flex align-items-center",children:[(0,o.child$)(n.state.click$,(()=>({})),{untilFirst:n}),{tag:"i",class:(0,o.attr$)(a.pipe((0,u.filter)((({step:e})=>[te.STARTED,te.DONE].includes(e)))),(e=>e.step==te.STARTED?"fas fa-spinner fa-spin p-3":""))}]}}class $s{constructor(){this.status$=new d.ReplaySubject(1),this.environments$=new d.BehaviorSubject([]),this.currentEnvironment$=new d.BehaviorSubject(""),this.selectedEnvId$=new d.BehaviorSubject(""),this.envSelectionState=new ke.Select.State(this.environments$,this.selectedEnvId$),this.selectedUserId$=new d.BehaviorSubject(localStorage.getItem("user-name")||"greinisch@youwol.com"),this.webSocket$=H.backs.connectWs()}subscribe(){return[this.webSocket$.pipe((0,u.filter)((({type:e})=>"Status"==e))).subscribe((({status:e})=>{this.status$.next(e)})),(0,d.combineLatest)([this.webSocket$.pipe((0,u.take)(1)),Ve.configurationUpdated$]).pipe((0,u.mergeMap)((()=>H.backs.status$()))).subscribe((e=>{this.status$.next(e.status)}))]}}class Ss{constructor(e){this.tag="div",this.class=J,this.state=e;let t=new oe(this.state.webSocket$);this.children=[{tag:"h3",class:"d-flex",children:[this.newBackBttn(),(0,o.child$)(e.status$,(()=>({children:[this.startBttn(),this.restartBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,o.child$)(e.status$,(e=>{return t=this.state.webSocket$,s=e,"",a=H.backs,0==s.filter((e=>"NOT_INSTALLED"==e.installStatus)).length?{}:{class:"overflow-auto",children:[{tag:"h4",innerText:"Assets to install"},K({innerText:""}),{tag:"table",class:"fv-color-primary mx-auto text-center my-2",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:s.filter((e=>"NOT_INSTALLED"==e.installStatus)).map((e=>({tag:"tr",children:[{tag:"td",innerText:e.name,style:{"font-family":"cursive","font-size":"large"}},ms(t,e,a)]})))}]}]};var t,s,a})),(0,o.child$)(e.status$,(e=>this.contentView(e))),new he(t)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}newBackBttn(){let e=Q("fas fa-plus","new backend-end");return e.state.click$.pipe((0,u.mergeMap)((()=>H.backs.skeletons$()))).subscribe((({skeletons:e})=>{Zt("New backend",e,H.backs)})),e}startBttn(){let e=Q("fas fa-play","Start");return e.state.click$.pipe((0,u.mergeMap)((()=>H.backs.start$()))).subscribe((()=>{})),e}restartBttn(){let e=Q("fas fa-play","Re-start");return e.state.click$.pipe((0,u.mergeMap)((()=>H.backs.restart$()))).subscribe((()=>{})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.tableView(e)]}}tableView(e){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""},{tag:"td",innerText:"Actions"},{tag:"td",innerText:"Health"}]}]},{tag:"tbody",children:e.filter((e=>"INSTALLED"==e.installStatus)).map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt",children:[ks(this.state,e),Ts(this.state,e),ys(this.state,e),(t=this.state,s=e,function(e,t,s){let a=e.webSocket$.pipe((0,u.filter)((e=>e.target==t.name&&"serve"==e.action)),(0,u.filter)((e=>["started","serving","done"].includes(e.step)))),n=new d.BehaviorSubject(t.health?s.serving:s.error);return{tag:"td",children:[(0,o.child$)(n,(e=>({tag:"i",class:e.class,onclick:e.onclick?e.onclick:()=>{}})))],connectedCallback:e=>{e.subscriptions.push(a.pipe((0,u.map)((e=>s[e.step]))).subscribe((e=>n.next(e))))}}}(t,s,{started:{class:"fas fa-spinner fa-spin fv-text-primary",onclick:void 0},serving:{class:"fv-text-success fas fa-check px-2",onclick:void 0},error:{class:"fv-text-error fas fa-times px-2",onclick:void 0},done:{class:"fv-text-error fas fa-times px-2",onclick:void 0}}))]};var t,s}))}]}}}let vs="fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus";function ks(e,t){return{tag:"td",innerText:t.name,style:{"font-family":"cursive","font-size":"large"}}}function Ts(e,t){return t.openApi?{tag:"td",innerHTML:`<a href='${t.openApi}'> doc </a> `}:{tag:"td"}}function ys(e,t){return{tag:"td",children:[{tag:"i",class:t.devServer?`fas fa-stop fv-text-primary ${vs}`:`fas fa-play fv-text-primary ${vs}`,onclick:()=>{t.devServer?H.backs.stop$(t.assetId).subscribe():H.backs.start$(t.assetId).subscribe()}}]}}class Ns{constructor(){this.packagesStatus$=H.localCdnPackages.packagesStatus$,this.packageDetails$=H.localCdnPackages.packageDetails$,this.selectedPackageVersion$=new d.BehaviorSubject(void 0),this.webSocket$=H.localCdnPackages.connectWs()}subscribe(){let e=this.packagesStatus$.subscribe((e=>console.log("packagesStatus",e))),t=this.packageDetails$.subscribe((e=>console.log("packageDetails",e)));return H.localCdnPackages.status$().subscribe(),[e,t]}getPackageDetails(e){H.localCdnPackages.getPackageDetails$(e).subscribe()}selectPackageVersion(e){this.selectedPackageVersion$.next(e)}}class Es{constructor(e){this.tag="div",this.class=J,this.state=e,this.children=[{class:"d-flex h-100 justify-content-around",children:[(0,o.child$)(this.state.packagesStatus$,(e=>this.packagesTable(e))),{class:"d-flex flex-column h-100 px-2",style:{maxWidth:"50%"},children:[(0,o.child$)(this.state.packageDetails$,(e=>e?this.packageDetails(e):{})),(0,o.child$)(this.state.selectedPackageVersion$,(e=>e?this.packageBrowserView(e):{}))]}]}],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}packagesTable(e){return{class:"overflow-auto h-100",children:[{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-2"},{tag:"td",innerText:"Version count",class:"px-2"},{tag:"td",innerText:"Latest version",class:"px-2"},{tag:"td",innerText:"",class:"px-2"}]}]},{tag:"tbody",children:e.packages.map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt fv-pointer",children:[Ds(e),Is(e),Rs(e),(t=e.name,{tag:"td",children:[{class:"fas fa-trash fv-text-error px-2 fv-pointer",onclick:()=>{confirm(`Are you sure you want to remove ${t} (all versions) from local CDN`)&&H.localCdnPackages.deletePackage$(t).subscribe()}}]})],onclick:()=>{this.state.getPackageDetails(e.name),this.state.selectPackageVersion(void 0)}};var t}))}]}]}}packageDetails(e){return{class:"overflow-auto",style:{maxHeight:"50%"},children:[{tag:"h4",class:"fv-text-focus",innerText:e.name},{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Version",class:"px-2"},{tag:"td",innerText:"files count",class:"px-2"},{tag:"td",innerText:"bundle size (Ko)",class:"px-2"},{tag:"td",innerText:"",class:"px-2"}]}]},{tag:"tbody",children:e.versions.map((t=>{return{tag:"tr",class:"fv-hover-bg-background-alt",onclick:()=>this.state.selectPackageVersion(t),children:[{tag:"td",innerText:t.version,class:"px-2"},{tag:"td",innerText:t.filesCount,class:"px-2"},{tag:"td",innerText:Math.floor(t.bundleSize/100)/10,class:"px-2"},(s=e.name,a=t.version,{tag:"td",children:[{class:"fas fa-trash fv-text-error px-2 fv-pointer",onclick:()=>{confirm(`Are you sure you want to remove ${s}@${a} from local CDN`)&&H.localCdnPackages.deleteVersion$(s,a).subscribe()}}]})]};var s,a}))}]}]}}packageBrowserView(e){let t=""==e.namespace?`/libraries/${e.name}`:`/libraries/${e.namespace}/${e.name}`,s=e.path.join("/").split(t)[0].split("/").length-2;return{class:"w-100 py-2 flex-grow-1",children:[{tag:"h4",class:"fv-text-focus",innerText:"Browser"},fe({startingFolder:e.path,originFolderIndex:s})]}}}function Ds(e){return{tag:"td",innerText:e.name,class:"px-2"}}function Is(e){return{tag:"td",innerText:e.versions.length,class:"px-2"}}function Rs(e){return{tag:"td",innerText:e.versions[0].version,class:"px-2"}}let Ps={[ve.LocalEnvPackage]:"Packages",[ve.LocalEnvFronts]:"Front Ends",[ve.LocalEnvBacks]:"Back Ends",[ve.LocalEnvCDN]:"CDN"};class Os{constructor(e){this.selectedPanel$=e,this.logMessages$=new d.Subject,this.modulesState=new rs,this.frontendsState=new es,this.backendsState=new $s,this.cdnState=new Ns}}class Vs extends Ue.Tabs.TabData{constructor(e){super(ve.LocalEnvPackage,Ps[ve.LocalEnvPackage]),this.modulesState=e}view(){return new is(this.modulesState)}}class As extends Ue.Tabs.TabData{constructor(e){super(ve.LocalEnvFronts,Ps[ve.LocalEnvFronts]),this.frontEndsState=e}view(){return new ts(this.frontEndsState)}}class Cs extends Ue.Tabs.TabData{constructor(e){super(ve.LocalEnvBacks,Ps[ve.LocalEnvBacks]),this.backendsState=e}view(){return new Ss(this.backendsState)}}class Bs extends Ue.Tabs.TabData{constructor(e){super(ve.LocalEnvCDN,Ps[ve.LocalEnvCDN]),this.cdnState=e}view(){return new Es(this.cdnState)}}class Ls{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=[new Vs(e.modulesState),new As(e.frontendsState),new Cs(e.backendsState),new Bs(e.cdnState)];this.children=[new Ue.Tabs.View({class:"d-flex flex-column h-100",state:new Ue.Tabs.State(t,e.selectedPanel$),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}s(897);let js=new class{constructor(){this.environmentChildren$=new d.BehaviorSubject([ve.ConfigurationGeneral,ve.ConfigurationRawFile]),this.localChildren$=new d.BehaviorSubject([ve.LocalEnvPackage,ve.LocalEnvFronts,ve.LocalEnvBacks,ve.LocalEnvCDN]),this.uploadChildren$=new d.BehaviorSubject([ve.AssetsUploadPackages,ve.AssetsUploadFluxApps,ve.AssetsUploadData,ve.AssetsUploadStories]),this.downloadChildren$=new d.BehaviorSubject([ve.AssetsDownloadPackages,ve.AssetsDownloadFluxApps]),this.selected$=new d.BehaviorSubject(ve.ConfigurationGeneral),this.localState=new Os(this.selected$),this.assetsUploadState=new Ut(this.selected$),this.assetsDownloadState=new nt(this.selected$),this.configurationState=new zt(this.selected$),this.panelViewFactory$=this.selected$.pipe((0,u.map)((e=>[ve.LocalEnvPackage,ve.LocalEnvFronts,ve.LocalEnvBacks,ve.LocalEnvCDN].includes(e)?new Ls(this.localState):[ve.AssetsUploadPackages,ve.AssetsUploadFluxApps,ve.AssetsUploadData,ve.AssetsUploadStories].includes(e)?new _t(this.assetsUploadState):[ve.ConfigurationGeneral,ve.ConfigurationRawFile].includes(e)?new Kt(this.configurationState):[ve.AssetsDownloadPackages,ve.AssetsDownloadFluxApps].includes(e)?new rt(this.assetsDownloadState):void 0)))}addTabUpload(e){let t=this.uploadChildren$.getValue();Ce[ve.AssetsUploadPackage]={title:e,enabled:!0},this.uploadChildren$.next([...t,ve.AssetsUploadPackage])}},Gs={class:"d-flex fv-text-primary h-100",children:[new class{constructor(e){this.state=e,this.tag="div",this.class="d-flex justify-content-center py-5 px-2 border h-100 ",this.style={"min-width":"300px"},this.children=[{class:"h-100 mx-auto d-flex flex-column pl-3",children:[{tag:"a",href:"/ui/workspace-explorer",class:"w-100 mb-2 d-flex justify-content-center",children:[{tag:"img",class:"mx-auto text-center fv-pointer",style:{width:"75%"},href:"/ui/workspace-explorer",src:"/api/assets-gateway/raw/package/QHlvdXdvbC9mbHV4LXlvdXdvbC1lc3NlbnRpYWxz/latest/assets/images/logo_YouWol_Platform_white.png"}]},(0,o.child$)(H.environment.environments$,(e=>{return{class:"mb-5",children:[{class:"d-flex align-items-center fv-hover-text-focus fv-pointer  justify-content-center",onclick:()=>Ne(),children:[{class:"fas fa-user"},{class:"fv-hover-text-focus fv-pointer mx-2",innerText:(t=e).userInfo.email}]},{class:"d-flex align-items-center justify-content-center",children:[{class:"fas fa-wifi px-2 "+(t.remoteGatewayInfo.connected?"fv-text-success":"fv-text-error")},{innerText:t.remoteGatewayInfo.host}]}]};var t})),je("Environment","fas fa-users-cog my-2",this.state.environmentChildren$,this.state.selected$),je("My computer","fas fa-laptop-code my-2",this.state.localChildren$,this.state.selected$),je("Upload assets","fas fa-cloud-upload-alt my-2",this.state.uploadChildren$,this.state.selected$),je("Download assets","fas fa-cloud-download-alt my-2",this.state.downloadChildren$,this.state.selected$),{class:"my-2 ",children:[Be("Resources","fas fa-book",new d.BehaviorSubject(!1)),(0,o.child$)(Ve.environment$,(e=>({tag:"ul",class:"d-flex flex-column",children:Object.entries(e.configuration.general.resources).map((([e,t])=>({tag:"li",children:[{tag:"a",href:t,innerText:e}]})))})))]}]}]}}(js),(0,o.child$)(js.panelViewFactory$,(e=>e))]},Fs=H.system.connectWs();Fs.pipe((0,u.filter)((e=>"SystemError"==e.type))).subscribe((e=>{let t=new Ge(e),s=new pe.Modal.View({state:t,contentView:Fe}),a=(0,o.render)(s);document.querySelector("body").appendChild(a),t.ok$.subscribe((()=>a.remove())),t.cancel$.subscribe((()=>a.remove()))})),Fs.pipe((0,u.take)(1)).subscribe((e=>{document.body.appendChild((0,o.render)(Gs))}))}}]);
//# sourceMappingURL=938.8332f3540e576f91fd26.js.map