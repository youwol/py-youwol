(self.webpackChunk=self.webpackChunk||[]).push([[240],{240:(e,t,s)=>{"use strict";s.r(t);var a,n,r,i,c,l=s(222),o=s(435),d=s(519);class u{static connectWs(){return u.webSocket$||(u.webSocket$=new o.ReplaySubject,new WebSocket(`ws://${window.location.host}${u.urlBase}/ws`).onmessage=e=>{u.webSocket$.next(JSON.parse(e.data))}),u.webSocket$}static status$(){let e=`${u.urlBase}/status`;return F(new Request(e,{method:"GET",headers:u.headers}))}static start$(e){let t=e?`${u.urlBase}/${e}/start`:`${u.urlBase}/start`;return F(new Request(t,{method:"POST",headers:u.headers}))}static restart$(){let e=`${u.urlBase}/restart`;return F(new Request(e,{method:"POST",headers:u.headers}))}static stop$(e){let t=`${u.urlBase}/${e}/stop`;return F(new Request(t,{method:"POST",headers:u.headers}))}static skeletons$(){let e=`${u.urlBase}/skeletons`;return F(new Request(e,{method:"GET",headers:u.headers}))}static createSkeleton$(e,t){let s=`${u.urlBase}/skeletons/${e}`;return F(new Request(s,{method:"POST",body:JSON.stringify(t),headers:u.headers}))}static install$(e){let t=`${u.urlBase}/${e}/install`;return F(new Request(t,{method:"POST",headers:u.headers}))}}u.urlBase="/admin/backends",u.headers={},function(e){e.NOT_FOUND="FluxAppStatus.NOT_FOUND",e.SYNC="FluxAppStatus.SYNC",e.MISMATCH="FluxAppStatus.MISMATCH",e.PROCESSING="FluxAppStatus.PROCESSING",e.DONE="FluxAppStatus.DONE"}(a||(a={}));class h{constructor(){}}class p extends h{constructor({fluxStatus:e,treeStatus:t,assetStatus:s}){super(),this.fluxStatus=e,this.treeStatus=t,this.assetStatus=s}}class f extends h{}class g{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new f:new p(a)}}class w{static connectWs(){return w.webSocket$||(w.webSocket$=new o.Subject,new WebSocket(`ws://${window.location.host}${w.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);w.webSocket$.next(t),t.target&&"flux-app"==t.target&&w.package$.next(new g(t))},this.package$.pipe((0,d.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.fluxApps$.next(e)}))),w.webSocket$}static status$(){this.package$.next(void 0);let e=`${w.urlBase}/status`,t=new Request(e,{method:"GET",headers:w.headers});return(0,o.combineLatest)([w.webSocket$.pipe((0,d.take)(1)),F(t)]).pipe((0,d.map)((([e,t])=>t)))}static publish$(e){let t=`${w.urlBase}/publish/${e}`;return F(new Request(t,{method:"POST",headers:w.headers}))}}w.urlBase="/admin/download/flux-apps",w.headers={},w.fluxApps$=new o.BehaviorSubject({}),w.package$=new o.ReplaySubject(1),function(e){e.PENDING="PENDING",e.SYNC="SYNC",e.OUTDATED="OUTDATED"}(n||(n={}));class x{static connectWs(){return x.webSocket$||(x.webSocket$=new o.ReplaySubject,new WebSocket(`ws://${window.location.host}${x.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);var s;x.webSocket$.next(t),(s=t).configurationPath&&s.userInfo&&s.users&&s.configuration&&s.remoteGatewayInfo&&s.remotesInfo&&x.environments$.next(t),function(e){return e.status&&e.components}(t)&&x.componentsUpdates$.next(t)}),x.webSocket$}static status$(){let e=`${x.urlBase}/status`;return F(new Request(e,{method:"GET",headers:x.headers}))}static fileContent$(){let e=`${x.urlBase}/file-content`;return F(new Request(e,{method:"GET",headers:x.headers}))}static switchConfiguration$(e){let t=`${x.urlBase}/switch-configuration`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:x.headers}))}static syncUser$(e){let t=`${x.urlBase}/sync-user`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:x.headers}))}static login$(e){let t=`${x.urlBase}/login`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:x.headers}))}static selectRemoteGateway$(e){let t=`${x.urlBase}/select-remote-gateway`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:x.headers}))}static postConfigParameters$(e){let t=`${x.urlBase}/configuration/parameters`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:x.headers}))}static triggerAvailableUpdates(){let e=`${x.urlBase}/available-updates`,t=new Request(e,{method:"GET",headers:x.headers});fetch(t).then()}static triggerSyncComponent(e){let t=`${x.urlBase}/sync-component`,s=new Request(t,{method:"POST",body:JSON.stringify(e),headers:x.headers});fetch(s).then()}}x.urlBase="/admin/environment",x.environments$=new o.ReplaySubject(1),x.componentsUpdates$=new o.ReplaySubject(1),x.headers={};class b{constructor(e){Object.assign(this,e)}}class m{static connectWs(){if(m.webSocket$)return m.webSocket$;m.webSocket$=new o.ReplaySubject(1);var e=new WebSocket(`ws://${window.location.host}${m.urlBase}/ws`);return x.environments$.pipe((0,d.mergeMap)((()=>this.status$()))).subscribe(),e.onmessage=e=>{console.log("Got data",e);let t=JSON.parse(e.data);m.webSocket$.next(t),t.target&&"downloadItem"==t.target&&m.downloadItem$.next(new b(t))},this.downloadItem$.pipe((0,d.scan)(((e,t)=>null==t?{}:{...e,[`${t.name}#${t.version}`]:t}),{})).subscribe((e=>{this.downloadItems$.next(e)})),m.webSocket$}static status$(){let e=`${m.urlBase}/status`,t=new Request(e,{method:"GET",headers:m.headers});return m.webSocket$.pipe((0,d.take)(1),(0,d.mergeMap)((()=>F(t))))}static getGroups$(){let e=`${m.urlBase}/groups`;return F(new Request(e,{method:"GET",headers:m.headers}))}static getDrives$(e){let t=`${m.urlBase}/groups/${e}/drives`;return F(new Request(t,{method:"GET",headers:m.headers}))}static packageInfo$(e){let t=`${m.urlBase}/info/${e}`;return F(new Request(t,{method:"GET",headers:m.headers}))}static download$(e){let t=`${m.urlBase}/synchronize`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:m.headers}))}}m.urlBase="/admin/download/packages",m.groups$=new o.Subject,m.headers={},m.downloadItem$=new o.Subject,m.downloadItems$=new o.BehaviorSubject({});class ${static connectWs(){return $.webSocket$||($.webSocket$=new o.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/frontends/ws`).onmessage=e=>{$.webSocket$.next(JSON.parse(e.data))}),$.webSocket$}static status$(){let e=`${$.urlBase}/status`;return F(new Request(e,{method:"GET",headers:$.headers}))}static start$(e){let t=`${$.urlBase}/${e}/start`;return F(new Request(t,{method:"POST",headers:$.headers}))}static stop$(e){let t=`${$.urlBase}/${e}/stop`;return F(new Request(t,{method:"POST",headers:$.headers}))}static skeletons$(){let e=`${$.urlBase}/skeletons`;return F(new Request(e,{method:"GET",headers:$.headers}))}static createSkeleton$(e,t){let s=`${$.urlBase}/skeletons/${e}`;return F(new Request(s,{method:"POST",body:JSON.stringify(t),headers:$.headers}))}}$.urlBase="/admin/frontends",$.headers={};class v{static connectWs(){return v.webSocket$||(v.webSocket$=new o.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/local-cdn/ws`).onmessage=e=>{let t=JSON.parse(e.data);v.webSocket$.next(t),t.target&&"PackagesStatus"==t.target&&(v.packagesStatus$.next(t.cdnStatus),v.packageDetails$.next(void 0)),t.target&&"PackageDetails"==t.target&&v.packageDetails$.next(t.packageDetails)}),v.webSocket$}static status$(){let e=`${v.urlBase}/status`;return F(new Request(e,{method:"GET",headers:v.headers}))}static getPackageDetails$(e){let t=`${v.urlBase}/packages/${e}`;return F(new Request(t,{method:"GET",headers:v.headers}))}static deleteVersion$(e,t){let s=`${v.urlBase}/libraries/${e}/${t}`;return F(new Request(s,{method:"DELETE",headers:v.headers}))}static deletePackage$(e){let t=`${v.urlBase}/packages/${e}`;return F(new Request(t,{method:"DELETE",headers:v.headers}))}}v.urlBase="/admin/local-cdn",v.packagesStatus$=new o.ReplaySubject(1),v.packageDetails$=new o.ReplaySubject(1),v.headers={};class S{static connectWs(){return S.webSocket$||(S.webSocket$=new o.ReplaySubject,new WebSocket(`ws://${window.location.host}${S.urlBase}/ws`).onmessage=e=>{S.webSocket$.next(JSON.parse(e.data))}),S.webSocket$}static status$(){let e=`${S.urlBase}/status`;return F(new Request(e,{method:"GET",headers:S.headers}))}static action$(e){let t=`${S.urlBase}/action`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:S.headers}))}static dependencies$(e){let t=`${S.urlBase}/${e}/dependencies`;return F(new Request(t,{method:"GET",headers:S.headers}))}static watch$(e){let t=`${S.urlBase}/watch`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:S.headers}))}static skeletons$(){let e=`${S.urlBase}/skeletons`;return F(new Request(e,{method:"GET",headers:S.headers}))}static createSkeleton$(e,t){let s=`${S.urlBase}/skeletons/${e}`;return F(new Request(s,{method:"POST",body:JSON.stringify(t),headers:S.headers}))}static install$(e){let t=`${S.urlBase}/${e}/install`;return F(new Request(t,{method:"POST",headers:S.headers}))}}S.urlBase="/admin/packages",S.headers={};class k{static connectWs(){return k.webSocket$||(k.webSocket$=new o.ReplaySubject,new WebSocket(`ws://${window.location.host}/admin/system/ws`).onmessage=e=>{k.webSocket$.next(JSON.parse(e.data))}),k.webSocket$}static folderContent$(e){let t=`${k.urlBase}/folder-content`,s={path:e};return F(new Request(t,{method:"POST",body:JSON.stringify(s),headers:k.headers}))}}k.urlBase="/admin/system",k.headers={},function(e){e.NOT_FOUND="DataStatus.NOT_FOUND",e.SYNC="DataStatus.SYNC",e.MISMATCH="DataStatus.MISMATCH",e.PROCESSING="DataStatus.PROCESSING",e.DONE="DataStatus.DONE"}(r||(r={}));class T{constructor(){}}class y extends T{constructor({dataStatus:e,treeStatus:t,assetStatus:s}){super(),this.dataStatus=e,this.treeStatus=t,this.assetStatus=s}}class N extends T{}class E{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new N:new y(a)}}class D{static connectWs(){return D.webSocket$||(D.webSocket$=new o.Subject,new WebSocket(`ws://${window.location.host}${D.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);D.webSocket$.next(t),t.target&&"data"==t.target&&D.package$.next(new E(t))},this.package$.pipe((0,d.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.data$.next(e)}))),D.webSocket$}static status$(){this.package$.next(void 0);let e=`${D.urlBase}/status`,t=new Request(e,{method:"GET",headers:D.headers});return(0,o.combineLatest)([D.webSocket$.pipe((0,d.take)(1)),F(t)]).pipe((0,d.map)((([e,t])=>t)))}static publish$(e){let t=`${D.urlBase}/publish/${e}`;return F(new Request(t,{method:"POST",headers:D.headers}))}}D.urlBase="/admin/upload/data",D.headers={},D.data$=new o.BehaviorSubject({}),D.package$=new o.ReplaySubject(1),function(e){e.NOT_FOUND="FluxAppStatus.NOT_FOUND",e.SYNC="FluxAppStatus.SYNC",e.MISMATCH="FluxAppStatus.MISMATCH",e.PROCESSING="FluxAppStatus.PROCESSING",e.DONE="FluxAppStatus.DONE"}(i||(i={}));class R{constructor(){}}class I extends R{constructor({fluxStatus:e,treeStatus:t,assetStatus:s}){super(),this.fluxStatus=e,this.treeStatus=t,this.assetStatus=s}}class P extends R{}class O{constructor({assetId:e,name:t,treeItems:s,status:a}){this.assetId=e,this.name=t,this.treeItems=s,this.status="string"==typeof a?new P:new I(a)}}class V{static connectWs(){return V.webSocket$||(V.webSocket$=new o.Subject,new WebSocket(`ws://${window.location.host}${V.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);V.webSocket$.next(t),t.target&&"flux-app"==t.target&&V.package$.next(new O(t))},this.package$.pipe((0,d.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.fluxApps$.next(e)}))),V.webSocket$}static status$(){this.package$.next(void 0);let e=`${V.urlBase}/status`,t=new Request(e,{method:"GET",headers:V.headers});return(0,o.combineLatest)([V.webSocket$.pipe((0,d.take)(1)),F(t)]).pipe((0,d.map)((([e,t])=>t)))}static publish$(e){let t=`${V.urlBase}/publish/${e}`;return F(new Request(t,{method:"POST",headers:V.headers}))}}V.urlBase="/admin/upload/flux-apps",V.headers={},V.fluxApps$=new o.BehaviorSubject({}),V.package$=new o.ReplaySubject(1),function(e){e.NOT_FOUND="PackageStatus.NOT_FOUND",e.SYNC="PackageStatus.SYNC",e.MISMATCH="PackageStatus.MISMATCH",e.PROCESSING="PackageStatus.PROCESSING",e.DONE="PackageStatus.DONE"}(c||(c={}));class A{constructor(){}}class C extends A{constructor({cdnStatus:e,treeStatus:t,assetStatus:s}){super(),this.cdnStatus=e,this.treeStatus=t,this.assetStatus=s}}class B extends A{}class L{constructor({assetId:e,name:t,namespace:s,treeItems:a,releases:n,status:r}){this.assetId=e,this.name=t,this.namespace=s,this.treeItems=a,this.releases=n,this.status="string"==typeof r?new B:new C(r)}}class j{constructor({assetId:e,name:t,namespace:s,version:a,status:n}){this.assetId=e,this.name=t,this.namespace=s,this.version=a,this.status=n}}class G{static connectWs(){return G.webSocket$||(G.webSocket$=new o.Subject,new WebSocket(`ws://${window.location.host}${G.urlBase}/ws`).onmessage=e=>{let t=JSON.parse(e.data);G.webSocket$.next(t),t.target&&"package"==t.target&&G.package$.next(new L(t)),t.target&&"packageVersion"==t.target&&G.packageVersion$.next(new j(t))},this.package$.pipe((0,d.scan)(((e,t)=>null==t?{}:{...e,[t.assetId]:t}),{})).subscribe((e=>{this.packages$.next(e)})),this.packageVersion$.pipe((0,d.scan)(((e,t)=>null==t?{}:{...e,[`${t.name}#${t.version}`]:t}),{})).subscribe((e=>{this.packageVersions$.next(e)}))),G.webSocket$}static status$(){this.package$.next(void 0),this.packageVersion$.next(void 0);let e=`${G.urlBase}/status`,t=new Request(e,{method:"GET",headers:G.headers});return(0,o.combineLatest)([G.webSocket$.pipe((0,d.take)(1)),F(t)]).pipe((0,d.map)((([e,t])=>t)))}static path$(e){let t=`${G.urlBase}/${e}/path`;return F(new Request(t,{method:"GET",headers:G.headers}))}static remotePath$(e){let t=`${G.urlBase}/${e}/remote-path`;return F(new Request(t,{method:"GET",headers:G.headers}))}static publishLibraryVersion$(e,t){let s=`${G.urlBase}/publish/${e}/${t}`;return F(new Request(s,{method:"POST",headers:G.headers}))}static deleteLibraryVersion$(e,t){let s=`${G.urlBase}/remove/${e}/${t}`;return F(new Request(s,{method:"DELETE",headers:G.headers}))}static syncPackage$(e){let t=`${G.urlBase}/publish/${e}`;return F(new Request(t,{method:"POST",headers:G.headers}))}static syncPackages$(e){let t=`${G.urlBase}/synchronize`;return F(new Request(t,{method:"POST",body:JSON.stringify(e),headers:G.headers}))}static registerAsset(e){let t=`${G.urlBase}/register-asset/${e}`;return F(new Request(t,{method:"POST",headers:G.headers}))}}function F(e,t=(e=>e)){return new o.Observable((s=>{fetch(e).then((e=>e.json())).then((e=>{s.next(t(e)),s.complete()})).catch((e=>s.error(e)))}))}G.urlBase="/admin/upload/packages",G.headers={},G.packages$=new o.BehaviorSubject({}),G.package$=new o.ReplaySubject(1),G.packageVersions$=new o.BehaviorSubject({}),G.packageVersion$=new o.ReplaySubject(1);class U{static setHeaders(e){U.headers=e,u.headers=e,k.headers=e,$.headers=e,S.headers=e,x.headers=e,G.headers=e,V.headers=e,D.headers=e,m.headers=e,v.headers=e,w.headers=e}}U.urlBase="/admin",U.headers={},U.system=k,U.fronts=$,U.backs=u,U.modules=S,U.environment=x,U.uploadPackages=G,U.downloadPackages=m,U.uploadFluxApps=V,U.uploadData=D,U.downloadFluxApps=w,U.localCdnPackages=v;var M=s(327);let _="p-2 fv-text-primary h-100 d-flex flex-column h-100";function q(e,t){return new M.Button.View({contentView:()=>({children:[{tag:"i",class:e},{tag:"span",class:"px-2",innerText:t}]}),class:"fv-btn fv-btn-secondary mx-2"})}function W(e,t=!1){let s=new o.BehaviorSubject(t);return{class:"d-flex align-items-top fv-bg-background-alt border rounded ",style:{"font-style":"oblique",width:"fit-content"},children:[{tag:"i",class:(0,l.attr$)(s,(e=>e?"fv-hover-text-primary fv-text-focus":"fv-hover-text-focus fv-text-primary "),{wrapper:e=>e+" fas py-2 px-3 fa-info fv-pointer fv-hover-text-focus "}),onclick:e=>{s.next(!s.getValue()),e.stopPropagation()}},{class:(0,l.attr$)(s,(e=>e?"py-3 pl-1 pr-3":"")),children:[(0,l.child$)(s,(t=>t?e:{}))]}]}}var Y,H,z,J,Q,K,X,Z,ee,te=s(888);!function(e){e.INSTALL="INSTALL",e.BUILD="BUILD",e.TEST="TEST",e.CDN="CDN",e.SYNC="SYNC",e.SERVE="SERVE"}(Y||(Y={})),function(e){e.TARGET_ONLY="TARGET_ONLY",e.ALL_ABOVE="ALL_ABOVE",e.ALL_BELOW="ALL_BELOW",e.ALL="ALL"}(H||(H={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(z||(z={})),function(e){e.STARTED="STARTED",e.PREPARATION="PREPARATION",e.STATUS="STATUS",e.RUNNING="RUNNING",e.PACKAGING="PACKAGING",e.DONE="DONE"}(J||(J={})),function(e){e.INSTALLED="INSTALLED",e.NOT_INSTALLED="NOT_INSTALLED"}(Q||(Q={})),function(e){e.SYNC="SYNC",e.RED="RED",e.NEVER_BUILT="NEVER_BUILT",e.OUT_OF_DATE="OUT_OF_DATE",e.INDIRECT_OUT_OF_DATE="INDIRECT_OUT_OF_DATE"}(K||(K={})),function(e){e.GREEN="GREEN",e.OUT_OF_DATE="OUT_OF_DATE",e.INDIRECT_OUT_OF_DATE="OUT_OF_DATE",e.RED="RED",e.NO_ENTRY="NO_ENTRY"}(X||(X={})),function(e){e.SYNC="SYNC",e.NOT_PUBLISHED="NOT_PUBLISHED",e.OUT_OF_DATE="OUT_OF_DATE",e.CDN_ERROR="CDN_ERROR"}(Z||(Z={})),function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(ee||(ee={}));class se{constructor({action:e,step:t,target:s,content:a,level:n,json:r,contextId:i}){this.contextId=void 0,this.children=[],this.action=e,this.step=t,this.target=s,this.content=a,this.level=n,this.json=r,this.contextId=i}}class ae{constructor(e){this.logs$=e,this.ongoingTasks$={}}}class ne extends te.ImmutableTree.Node{constructor({name:e,data:t}){super({id:`${Math.floor(1e6*Math.random())}`,children:ne.getChildren(t)}),this.name=e,this.data=t}static getChildren(e){return null!=e&&null!=e&&"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e?(0,o.of)(Object.entries(e).map((([e,t])=>new ne({name:e,data:t})))):void 0}}let re={[J.STATUS]:"fas fa-info",[J.STARTED]:"fas fa-play",[J.PREPARATION]:"fas fa-running",[J.RUNNING]:"fas fa-running",[J.PACKAGING]:"fas fa-archive",[J.DONE]:"far fa-flag"};class ie{constructor(e){this.state=e,this.class="h-25 d-flex flex-column",this.children=[this.header(),this.content()]}header(){return{tag:"hr",class:"fv-color-primary w-100"}}content(){return{class:" fv-bg-background-alt flex-grow-1 overflow-auto d-flex flex-column",children:(0,l.childrenAppendOnly$)(this.state.logs$.pipe((0,d.map)((e=>[new se(e)])),(0,d.filter)((([e])=>e.level!=ee.DEBUG&&null!=e.step))),(e=>this.messageView(e)),{sideEffects:e=>e.scrollTop=e.scrollHeight})}}messageView(e){let t=e.json?this.jsonView(e.json):{};return{class:"d-flex align-items-center my-1 "+(e.level==ee.ERROR?"fv-text-error fv-bg-on-error":"fv-text-primary"),children:[{class:"px-1 "+re[e.step],tag:"i"},{class:"px-2",tag:"i",innerText:e.action},,{class:"px-2",tag:"i",innerText:e.target},{class:"px-2 d-flex align-items-center",children:[{class:"mx-2",innerHTML:e.content},t]}]}}jsonView(e){let t=new ne({name:"data",data:e}),s=new te.ImmutableTree.State({rootNode:t});return new te.ImmutableTree.View({state:s,headerView:(e,t)=>{let s={innerText:t.name};return t.children?s:{class:"d-flex align-items-baseline",children:[s,{tag:"i",class:"px-2",innerText:t.data}]}}})}}var ce=s(337);function le({startingFolder:e,originFolderIndex:t,configFileView:s,style:a}){let n=new o.BehaviorSubject(e),r=n.pipe((0,d.mergeMap)((e=>U.system.folderContent$(e))));return s=s||((e,t)=>ue(t)),{class:"fv-bg-background fv-text-primary border rounded p-4 w-100 overflow-auto",style:a||{},children:[oe(e,t),de(n,t),{class:"my-4",children:(0,l.children$)(r,(({configurations:e,files:t,folders:a})=>{let r=e.map((e=>s(n,e))),i=t.map((e=>ue(e)));return[...r,...a.map((e=>function(e,t){return{class:"fv-pointer d-flex align-items-center fv-hover-bg-background-alt",children:[{class:"fas fa-folder px-2"},{innerText:t,onclick:()=>e.next(e.getValue().concat(t))}]}}(n,e))),...i]}))}]}}function oe(e,t){return 0==t?{}:{class:"d-flex  mx-2",children:[{innerText:"origin location:"},{class:"px-2",innerText:e.slice(1,t).reduce(((e,t)=>`${e}/${t}`))}]}}function de(e,t){return{class:"d-flex",children:(0,l.children$)(e,(s=>s.slice(t).map((t=>function(e,t){let s=e.getValue().indexOf(t);return{class:"px-2 fv-pointer fv-hover-bg-background-alt border rounded mx-2",innerText:t,onclick:()=>e.next(e.getValue().slice(0,s+1))}}(e,t)))))}}function ue(e){return{class:"d-flex  align-items-center fv-text-disabled",style:{"user-select":"none"},children:[{class:"fas fa-file px-2"},{innerText:e}]}}class he extends ce.Modal.State{constructor(e){super(),this.environment=e,this.startingFolder=e.configurationPath.slice(0,-1)}}function pe(e){console.log(e);let t=new he(e),s=new ce.Modal.View({state:t,contentView:fe}),a=(0,l.render)(s);document.querySelector("body").appendChild(a),t.ok$.subscribe((()=>a.remove())),t.cancel$.subscribe((()=>a.remove()))}function fe(e){return le({startingFolder:e.startingFolder,originFolderIndex:0,configFileView:(t,s)=>function(e,t,s,a){let n=e.getValue();return{class:"fv-pointer d-flex  align-items-center fv-hover-bg-background-alt fv-text-focus",style:{"font-weight":JSON.stringify(n.concat(t))===JSON.stringify(s)?"bolder":"inherit"},children:[{class:"fas fa-file px-2"},{innerText:t}],onclick:s=>{a.next(s),Ee.switchConfiguration([...e.getValue(),t])}}}(t,s,e.environment.configurationPath,e.ok$),style:{width:"50vw",height:"50vh",overflow:"auto"}})}function ge(e){return{class:"fv-text-focus fv-pointer",innerText:e.configurationPath.slice(1).join("/"),style:{"font-size":"large"},onclick:()=>pe(e)}}var we,xe=s(313);class be extends ce.ExpandableGroup.State{constructor(e){super("User info"),this.environment=e}}function me(e){return{className:ce.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,l.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-users"},{innerText:"User info",class:"px-2",style:{"font-size":"large"}},{class:"fv-text-focus px-2",children:[{innerText:`Logged as ${e.environment.userInfo.name}`}]}]}}function $e(){let e=new ce.Modal.State,t=q("","Sign-in"),s=new o.Subject,a=new o.Subject,n=new ce.Modal.View({state:e,contentView:()=>({class:"fv-text-primary fv-bg-background-alt p-4 rounded border fv-color-primary",style:{"max-width":"500px"},children:[{class:"d-flex align-items-baseline py-2 text-center mx-auto justify-content-center",children:[{tag:"h4",class:"text-center fv-text-focus",innerText:"Synchronize with remote user"}]},{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle fa-2x px-3"},{tag:"div",innerHTML:"Provide the email adress and password of the user for which you want to synchronize the profile.  Please make sure your internet connection is turned on."}]},{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-baseline w-100",children:[{tag:"i",class:"fas fa-at px-3"},{tag:"input",type:"text",class:"flex-grow-1",onchange:e=>s.next(e.target.value)}]},{class:"d-flex align-items-baseline w-100 my-2",children:[{tag:"i",class:"fas fa-key px-3"},{tag:"input",type:"password",class:"flex-grow-1",onchange:e=>a.next(e.target.value)}]},{class:"pt-3",children:[t]}]})}),r=(0,l.render)(n);document.body.appendChild(r),e.cancel$.subscribe((()=>r.remove())),t.state.click$.pipe((0,d.withLatestFrom)((0,o.combineLatest)([s,a])),(0,d.mergeMap)((([e,[t,s]])=>U.environment.syncUser$({email:t,password:s,remoteEnvironment:"dev.platform.youwol.com"})))).subscribe((e=>{console.log(e),r.remove()}),(e=>r.remove()))}class ve extends ce.ExpandableGroup.State{constructor(e){super("User info"),this.environment=e}}function Se(e){return{className:ce.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,l.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-cog"},{innerText:"Configuration parameters",class:"px-2",style:{"font-size":"large"}}]}}class ke extends ce.ExpandableGroup.State{constructor(e){super("Remote info"),this.gatewayInfo=e}}function Te(e){return{className:ce.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,l.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},{tag:"i",class:"fas fa-wifi "+(e.gatewayInfo.connected?"fv-text-success":"fv-text-error")},{innerText:"Remote info",class:"px-2",style:{"font-size":"large"}},{class:"fv-text-focus px-2",children:[{innerText:e.gatewayInfo.name}]}]}}class ye extends ce.ExpandableGroup.State{constructor(e){super("YouWol updates",ye.isExpanded(e)),this.availableUpdates=e}static isExpanded(e){return e.status!=n.PENDING&&!e.components.reduce(((e,t)=>e&&t.latestVersion==t.localVersion),!0)}}function Ne(e){let t={[n.PENDING]:{class:"fas fa-spinner fa-spin"},[n.OUTDATED]:{class:"fas fa-exclamation fv-text-focus"},[n.SYNC]:{class:"fas fa-check fv-text-success"}};return{className:ce.ExpandableGroup.defaultHeaderClass,children:[{tag:"i",className:(0,l.attr$)(e.expanded$,(e=>e?"fa-caret-down":"fa-caret-right"),{wrapper:e=>"px-2 fas "+e})},t[e.availableUpdates.status],{innerText:e.name,class:"px-2",style:{"font-size":"large"}}]}}class Ee{constructor(){}static subscribe(){return Ee.webSocket$.pipe((0,d.take)(1),(0,d.mergeMap)((()=>U.environment.status$()))).subscribe((e=>Ee.cacheConfigurationPath(e.configurationPath)))}static switchConfiguration(e){U.environment.switchConfiguration$({path:e}).subscribe()}static getCachedConfigurationPaths(){return JSON.parse(localStorage.getItem("youwol-local-dashboard")||"{}").configurationPaths||[]}static cacheConfigurationPath(e){let t=Ee.getCachedConfigurationPaths();if(t.includes(e))return;t=t.filter((t=>t!=e)).concat([e]);let s={configurationPaths:t};localStorage.setItem("youwol-local-dashboard",JSON.stringify(s)),Ee.configurationPaths$.next(t)}syncComponent(e){U.environment.triggerSyncComponent({name:e.name,version:e.latestVersion})}}Ee.webSocket$=U.environment.connectWs(),Ee.environment$=Ee.webSocket$.pipe((0,d.filter)((e=>"Environment"==e.type))),Ee.loadingStatus$=Ee.webSocket$.pipe((0,d.filter)((e=>"LoadingStatus"==e.type))),Ee.configurationUpdated$=Ee.webSocket$.pipe((0,d.filter)((e=>"ConfigurationUpdated"==e.type))),Ee.componentsUpdates$=U.environment.componentsUpdates$,Ee.configurationPaths$=new o.BehaviorSubject(Ee.getCachedConfigurationPaths());class De{constructor(e){this.tag="div",this.class=_,this.state=e;let t=new ae(Ee.webSocket$.pipe((0,d.map)((e=>e))));U.environment.triggerAvailableUpdates(),this.children=[{class:"flex-grow-1",children:[(0,l.child$)(Ee.environment$,(e=>{return{class:"flex-grow-1",children:[{class:"d-flex align-items-center",children:[{class:"p-2",style:{"font-size":"large"},innerText:"configuration:"},ge(t=e),{class:"fv-pointer mx-3 fas fa-folder-open border rounded p-2 fv-hover-bg-background-alt",onclick:()=>pe(t)}]}]};var t})),(0,l.child$)(Ee.environment$,(e=>{return t=e,new ce.ExpandableGroup.View({state:new ve(t),headerView:Se,contentView:e=>{return{class:"border rounded fv-color-primary p-2",children:[W({innerText:"These parameters are those declared in your configuration file. They can control behaviors of the different pipelines.\n                Refer to the configuration file for more information on the meaning of these parameters.\n                "}),(s=t.configurationParameters.parameters,{class:"my-2",children:Object.entries(s).map((([e,t])=>{let s={};return"ENUM"==t.meta.type&&(s=function(e,t){let s=t.meta.values.map((e=>new xe.Select.ItemData(e,e))),a=new xe.Select.State(s,t.value);return a.selectionId$.pipe((0,d.filter)((e=>e!=t.value)),(0,d.mergeMap)((t=>U.environment.postConfigParameters$({values:{[e]:t}})))).subscribe((()=>{})),new xe.Select.View({state:a})}(e,t)),{class:"border rounded p-2",children:[{class:"d-flex align-items-center",children:[{class:"px-2 fv-text-focus",innerText:t.name+":"},s]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle px-3"},{innerText:t.description}]}]}}))})]};var s},className:"my-2"});var t})),(0,l.child$)(Ee.environment$,(e=>function(e){let t=e.users.map((e=>new xe.Select.ItemData(e,e))),s=new o.BehaviorSubject(e.userInfo.email),a=new xe.Select.State(t,s);a.selectionId$.pipe((0,d.skip)(1),(0,d.distinctUntilChanged)(),(0,d.mergeMap)((e=>U.environment.login$({email:e})))).subscribe((()=>{}));let n=q("fas fa-plus","sync. user");return n.state.click$.subscribe((()=>$e())),new ce.ExpandableGroup.View({state:new be(e),headerView:me,contentView:t=>({class:"border rounded fv-color-primary p-2",children:[W({tag:"ul",innerText:"To better work with local YouWol it is preferable to sync your user info with your remotes account.\n                It is required when:\n                ",children:[{tag:"li",innerText:"When pushing or pulling data"}]}),{class:"d-flex align-items-center",children:[{innerText:"Current user:"},new xe.Select.View({state:a,class:"mx-2"}),n]},{children:[{tag:"ul",innerText:"Member of:",children:e.userInfo.memberOf.map((e=>({tag:"li",class:"",innerText:e})))}]}]}),className:"my-2"})}(e))),(0,l.child$)(Ee.environment$,(e=>function(e){let t=e.remotesInfo.map((({host:e})=>new xe.Select.ItemData(e,e))),s=new o.BehaviorSubject(e.remoteGatewayInfo.host),a=new xe.Select.State(t,s);return a.selectionId$.pipe((0,d.skip)(1),(0,d.distinctUntilChanged)(),(0,d.mergeMap)((e=>U.environment.selectRemoteGateway$({name:e})))).subscribe((()=>{})),new ce.ExpandableGroup.View({state:new ke(e.remoteGatewayInfo),headerView:Te,contentView:t=>({class:"border rounded fv-color-primary p-2",children:[W({innerText:"The remote environment with which you want to synchronize your work."}),{class:"d-flex align-items-center",children:[{innerText:"Current environment:"},new xe.Select.View({state:a,class:"mx-2"})]},{tag:"ul",innerText:"Info",children:[{tag:"li",innerText:"name: "+e.remoteGatewayInfo.name},{tag:"li",innerText:"host: "+e.remoteGatewayInfo.host},{tag:"li",innerText:"connected: "+e.remoteGatewayInfo.connected}]}]}),className:"my-2"})}(e))),(0,l.child$)(Ee.componentsUpdates$,(t=>function(e,t){let s={tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Local version"},{tag:"td",innerText:"Latest version"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:t.components.map((t=>({tag:"tr",class:"fv-hover-bg-background-alt",children:[{tag:"td",innerText:t.name},{tag:"td",innerText:t.localVersion},{tag:"td",innerText:t.latestVersion},{tag:"td",children:[t.localVersion==t.latestVersion?{}:{class:"fas fa-sync fv-text-focus fv-pointer",onclick:()=>{e.syncComponent(t)}}]}]})))}]};return new ce.ExpandableGroup.View({state:new ye(t),headerView:Ne,contentView:e=>({class:"border rounded fv-color-primary p-2",children:[W({innerText:"The updates available."}),t.status==n.PENDING?{class:"fas fa-spinner fa-spin"}:s]}),className:"my-2"})}(e,t)))]},new ie(t)],this.connectedCallback=e=>{e.subscriptions.push(Ee.subscribe())}}}!function(e){e.ConfigurationGeneral="conf.general",e.ConfigurationRawFile="conf.raw-file",e.LocalEnvPackage="local.packages",e.LocalEnvFronts="local.fronts",e.LocalEnvBacks="local.backs",e.LocalEnvCDN="local.cdn",e.AssetsUploadPackages="upload.packages",e.AssetsUploadFluxApps="upload.fluxapps",e.AssetsDownloadFluxApps="download.fluxapps",e.AssetsUploadData="upload.data",e.AssetsUploadPackage="upload.AssetsUploadPackage",e.AssetsDownloadPackages="download.packages"}(we||(we={}));let Re={[we.ConfigurationGeneral]:{title:"General",enabled:!0},[we.ConfigurationRawFile]:{title:"Raw file",enabled:!0},[we.LocalEnvPackage]:{title:"Packages",enabled:!0},[we.LocalEnvFronts]:{title:"Front Ends",enabled:!0},[we.LocalEnvBacks]:{title:"Back Ends",enabled:!0},[we.LocalEnvCDN]:{title:"CDN",enabled:!0},[we.AssetsUploadPackages]:{title:"Packages",enabled:!0},[we.AssetsUploadFluxApps]:{title:"Flux apps",enabled:!0},[we.AssetsUploadData]:{title:"Data",enabled:!0},[we.AssetsDownloadFluxApps]:{title:"Flux apps",enabled:!0},[we.AssetsUploadData]:{title:"Data",enabled:!0},[we.AssetsDownloadPackages]:{title:"Packages",enabled:!0}};function Ie(e,t,s,a=!0){return{class:(0,l.attr$)(s,(e=>e?"fv-text-focus":""),{wrapper:e=>e+"  d-flex align-items-center fa-2x "+(a?"fv-pointer":"")}),children:[{tag:"i",class:t+" pr-3"},{tag:"h4",innerText:e,style:{"user-select":"none"}}]}}function Pe(e,t){return{tag:"ul",children:(0,l.children$)(e,(e=>e.map((e=>function(e,t){let s=Re[e].enabled;return{tag:"li",innerText:Re[e].title,class:(0,l.attr$)(t,(t=>t==e?"fv-text-focus":s?"fv-pointer":"fv-text-background-alt")),style:{"user-select":"none"},onclick:a=>{s&&t.next(e),a.stopPropagation()}}}(e,t)))))}}function Oe(e,t,s,a,n=!0){return{class:"my-2 "+(n?"":"fv-text-disabled"),children:[Ie(e,t,a.pipe((0,d.mergeMap)((e=>s.pipe((0,d.map)((t=>t.includes(e))))))),n),Pe(s,a)]}}class Ve extends ce.Modal.State{constructor(e){super(),this.error=e}}function Ae(e){let t=new ce.ExpandableGroup.State("trace"),s=new ce.ExpandableGroup.View({state:t,headerView:ce.ExpandableGroup.defaultHeaderView,contentView:()=>({children:e.error.trace.map((e=>({innerText:e})))})});return{class:"fv-color-focus rounded fv-bg-background fv-text-primary d-flex flex-column p-4",children:[{tag:"h2",class:"text-center w-100 py-2 fv-text-error",innerText:"System error"},{class:"text-center w-100 py-2",innerText:"Details: "+e.error.details},s]}}var Ce=s(690),Be=s(444),Le=s(71);class je extends Le.ModuleExplorer.Node{constructor({id:e,name:t,basePath:s}){super({id:e,name:t,children:je.groups$(s),events$:je.events$}),this.basePath=s}static groups$(e){return new Be.AssetsGatewayClient({basePath:e}).getGroups(je.events$).pipe((0,d.map)((({groups:t})=>t.map((t=>new Ge({group:t,basePath:e}))))))}}je.events$=new o.ReplaySubject;class Ge extends Le.ModuleExplorer.Node{constructor({group:e,basePath:t}){super({id:e.id,name:e.path,children:Ge.drives$(e.id,t),events$:Ge.events$.pipe((0,d.filter)((t=>t.targetId==e.id)))}),this.group=e,this.name=e.path,this.basePath=t}static drives$(e,t){let s=new Be.AssetsGatewayClient({basePath:t});return s.getDrives(e,Ge.events$).pipe((0,d.map)((({drives:e})=>e.map((({driveId:e,name:t})=>{let a=new Be.Drive(e,t,s);return new Le.ModuleExplorer.DriveNode({drive:a})})))))}}Ge.events$=new o.ReplaySubject;let Fe={"PackageStatus.NOT_FOUND":"far fa-circle fv-text-disabled","PackageStatus.MISMATCH":"fas fa-exclamation fv-text-focus","PackageStatus.SYNC":"fas fa-check fv-text-success","PackageStatus.PROCESSING":"fas fa-spinner fa-spin"};class Ue{constructor(){this.fetchDependenciesLatest$=new o.BehaviorSubject(!0),this.options$=(0,o.combineLatest)([this.fetchDependenciesLatest$]).pipe((0,d.map)((([e])=>({fetchDependenciesLatest:e})))),this.webSocket$=U.downloadPackages.connectWs(),this.logsState=new ae(this.webSocket$.pipe((0,d.map)((e=>e)))),this.selectedNode$=new o.ReplaySubject,this.queuedToDownload$=U.downloadPackages.downloadItems$.pipe((0,d.map)((e=>Object.values(e)))),this.toggled$=new o.BehaviorSubject([]),this.selectedNode$.pipe((0,d.filter)((e=>e instanceof Le.ModuleExplorer.FileNode&&e.file instanceof Be.File&&"package"==e.file.metadata.kind)),(0,d.map)((e=>e.file)),(0,d.mergeMap)((e=>U.downloadPackages.packageInfo$(e.metadata.rawId)))).subscribe()}subscribe(){return U.uploadPackages.status$().subscribe(),[U.downloadPackages.downloadItems$.subscribe((e=>{let t=Object.values(e).filter((e=>e.status!=c.SYNC)).map((e=>e.name));this.toggled$.next(t)}))]}toggle(e){let t=this.toggled$.getValue().includes(e)?this.toggled$.getValue().filter((t=>t!=e)):this.toggled$.getValue().concat([e]);this.toggled$.next(t)}synchronize(){(0,o.combineLatest)([this.queuedToDownload$,this.toggled$]).pipe((0,d.take)(1),(0,d.mergeMap)((([e,t])=>{let s=e.filter((e=>t.includes(e.name)));return U.downloadPackages.download$({packages:s})}))).subscribe()}}class Me{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.headerView(),this.contentView()]},new ie(e.logsState)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}headerView(){let e=new ce.ExpandableGroup.State("options",!1),t=(e,t)=>{let s=new M.Switch.State(e);return{class:"d-flex align-items-center ",children:[{innerText:t,class:(0,l.attr$)(s.value$,(e=>e?"fv-text-focus":""),{wrapper:e=>e+" px-2"})},new M.Switch.View({state:s})]}};return new ce.ExpandableGroup.View({state:e,class:"mx-3 mb-3",headerView:ce.ExpandableGroup.defaultHeaderView,contentView:()=>({class:"d-flex w-100 justify-content-around align-items-center border rounded ",children:[t(this.state.fetchDependenciesLatest$,"fetch dependencies @ latest")]})})}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[(0,l.child$)(U.downloadPackages.status$(),(()=>function(e){let t=new te.ImmutableTree.State({rootNode:new je({id:"root",name:"groups",basePath:"/remote/api/assets-gateway"}),selectedNode:e.selectedNode$});return{class:"d-flex h-100 flex-column",children:[{innerText:"Remote workspace"},new te.ImmutableTree.View({state:t,headerView:_e,connectedCallback:t=>{t.subscriptions.push(e.selectedNode$.subscribe((e=>{console.log("Node selected",e)})))},class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}(this.state)),{untilFirst:{class:"fas fa-spinner fa-spin m-auto"}}),(e=this.state,{class:"d-flex h-100 flex-column",children:[{innerText:"Download queue"},{tag:"table",class:"w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-3"},{tag:"td",innerText:"Version",class:"px-3"},{tag:"td",innerText:"Status",class:"px-3"},{tag:"td",innerText:"Queued?",class:"px-3"}]}]},{tag:"tbody",children:(0,l.childrenWithReplace$)(e.queuedToDownload$,(t=>(t=>({tag:"tr",class:"fv-pointer fv-hover-bg-background-alt ",children:[{tag:"td",innerText:t.name},{tag:"td",innerText:t.version},{tag:"td",children:[{class:Fe[t.status]}]},{tag:"input",type:"checkbox",checked:(0,l.attr$)(e.toggled$,(e=>e.includes(t.name))),onclick:()=>e.toggle(t.name)}]}))(t)),{})}]},(0,l.child$)(e.toggled$,(t=>(t=>{let s={};if(0==t.length)s={innerText:"No items selected for synchronization",class:"fv-text-focus"};else{let a=q("fas fa-sync",`Sync. (${t.length})`);a.state.click$.subscribe((t=>e.synchronize())),s=a}return{class:"w-100",children:[{class:" border fv-color-primary"},{class:"m-3",children:[s]}]}})(t)))]})]}]};var e}}function _e(e,t){let s=[{target:e=>e instanceof Le.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof Le.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof Ge&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof je||e instanceof Ge&&!e.id.includes("private"),icon:"fas fa-users"}];return Le.ModuleExplorer.headerView(e,t,s)}class qe{constructor(e){this.appState=e,this.webSocket$=U.downloadFluxApps.connectWs(),this.logsState=new ae(this.webSocket$.pipe((0,d.map)((e=>e))))}subscribe(){return[]}}class We{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new o.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new ie(e.logsState)]}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[He(this.state)]}]}}}class Ye extends te.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function He(e){let t=new Ye({rootNode:new je({id:"root",name:"groups",basePath:"/remote/api/assets-gateway"}),status$:e.webSocket$.pipe((0,d.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Remote workspace:"},new te.ImmutableTree.View({state:t,headerView:ze,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function ze(e,t){let s=[{target:e=>e instanceof Le.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof Le.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof Ge&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof je||e instanceof Ge&&!e.id.includes("private"),icon:"fas fa-users"}];return t instanceof Le.ModuleExplorer.FileNode&&t.file.metadata&&"flux-project"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>U.downloadFluxApps.publish$(t.id).subscribe(),class:"fas fa-cloud-download-alt fv-hover-text-focus mx-2 fv-pointer"},(0,l.child$)(e.status$.pipe((0,d.filter)((e=>e.assetId==t.id))),(({status:e})=>e==i.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:Le.ModuleExplorer.headerView(e,t,s)}class Je extends Ce.Tabs.TabData{constructor(){super(we.AssetsDownloadPackages,Re[we.AssetsDownloadPackages].title),this.packagesState=new Ue}view(){return new Me(this.packagesState)}}class Qe extends Ce.Tabs.TabData{constructor(e){super(we.AssetsDownloadFluxApps,Re[we.AssetsDownloadFluxApps].title),this.state=e}view(){return new We(this.state)}}class Ke extends Ce.Tabs.State{constructor(e){super([new Je,new Qe(new qe(e))],e.selectedPanel$)}}class Xe{constructor(e){this.selectedPanel$=e}}class Ze{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=new Ke(e);this.children=[new Ce.Tabs.View({class:"d-flex flex-column h-100",state:t,headerView:et,contentView:(e,t)=>t.view()})],this.connectedCallback=e=>{}}}function et(e,t){return{innerText:t.name,class:"px-2"}}function tt(e){let t=new ce.ExpandableGroup.State("Explorer",!1);return new ce.ExpandableGroup.View({state:t,headerView:at,contentView:t=>({class:"my-2 h-100 w-100",style:{"white-space":"nowrap"},children:[{class:"d-flex justify-content-around",children:[{innerText:"Local reference"},{innerText:"Remote reference"}]},{class:"d-flex justify-content-around",children:[{class:"w-50 d-flex justify-content-center",children:[(0,l.child$)(U.uploadPackages.path$(e.treeItems[0].itemId),(e=>rt(e)))]},{class:"w-50  d-flex justify-content-center",children:[(0,l.child$)(U.environment.environments$.pipe((0,d.mergeMap)((()=>U.uploadPackages.remotePath$(e.assetId)))),(e=>e.group&&e.drive&&e.folders?rt(e):{class:"fas fa-times fv-text-error"}),{untilFirst:{class:"fas fa-spinner fa-spin fv-text-primary mx-auto my-auto"}})]}]}]}),class:"mb-3"})}function st(e){let t=new ce.ExpandableGroup.State("CDN versions",!0);return new ce.ExpandableGroup.View({state:t,headerView:at,contentView:()=>({class:"d-flex justify-content-center",children:[it(e)]}),class:"mb-3"})}function at(e){return ce.ExpandableGroup.defaultHeaderView(e)}function nt(e){return{class:"d-flex justify-content-center align-items-center ",children:[{tag:"h3",class:"text-center my-2",innerText:e.name}]}}function rt({group:e,drive:t,folders:s}){return{class:"border rounded fv-color-primary p-2 mx-2",style:{width:"fit-content"},children:[{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-users px-2"},{innerText:e}]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-hdd px-2"},{innerText:t.name}]},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-folder px-2"},{innerText:s.reduce(((e,t)=>e+" / "+t.name),"")}]}]}}function it(e){let t=U.uploadPackages.packageVersions$.pipe((0,d.map)((e=>Object.values(e))),(0,d.map)((t=>t.filter((({name:t})=>t==e.name)))));return{tag:"table",class:"fv-color-primary text-center my-3",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Local versions",class:"px-3"},{tag:"td",innerText:"Published versions",class:"px-3"},{tag:"td",innerText:"",class:"px-3"},{tag:"td",innerText:"",class:"px-3"}]}]},(0,l.child$)(t,(t=>({tag:"tbody",children:t.map((({assetId:t,name:s,version:a,status:n})=>({tag:"tr",class:"fv-hover-bg-background-alt",children:[{tag:"td",innerText:a,class:"px-3"},{tag:"td",class:"px-3",children:[{tag:"i",class:Fe[n]}]},lt(e,a),ot(e,a)]})))})))]}}function ct(e,t){return{tag:"td",class:"mx-2",children:[{tag:"i",class:`fas ${t} fv-hover-text-focus p-2 fv-pointer`,onclick:e},{}]}}function lt(e,t){return ct((()=>U.uploadPackages.publishLibraryVersion$(e.assetId,t).subscribe()),"fa-cloud-upload-alt")}function ot(e,t){return ct((()=>{confirm(`Are you sure you want to remove ${e.name}/${t} from local & deployed CDN`)&&U.uploadPackages.deleteLibraryVersion$(e.assetId,t).pipe((0,d.mergeMap)((()=>U.uploadPackages.status$()))).subscribe()}),"fa-trash fv-text-error ml-4")}function dt(e,t,s){return{tag:"table",class:"w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-3"},{tag:"td",innerText:"Version",class:"px-3"},{tag:"td",innerText:"Status",class:"px-3"},{tag:"td",innerText:"Queued?",class:"px-3"}]}]},{tag:"tbody",children:e.map((({assetId:e,name:a,version:n,status:r})=>{let i="fv-pointer fv-hover-bg-background-alt ";return(!t.showSynced&&r==c.SYNC||!t.showNext&&n.includes("-next"))&&(i+="d-none"),{tag:"tr",class:i,children:[{tag:"td",innerText:a},{tag:"td",innerText:n},{tag:"td",children:[{class:Fe[r]}]},{tag:"input",type:"checkbox",checked:(0,l.attr$)(s.isToggled$(e,n),(e=>e)),onclick:()=>s.toggleSync(e,n)}]}}))}]}}function ut(e,t){let s="";return e.status instanceof B&&(s="fas fa-spinner fa-spin"),e.status instanceof C&&(s=Fe[e.status.cdnStatus]),{tag:"td",children:[{class:s}]}}function ht(e,t){let s="",a={};return e.status instanceof B&&(s="fas fa-spinner fa-spin"),e.status instanceof C&&(s=Fe[e.status.treeStatus],e.status.treeStatus!=c.SYNC&&(a={class:"fas fa-cloud-upload-alt fv-hover-text-focus fv-pointer",onclick:t=>{U.uploadPackages.registerAsset(e.assetId).subscribe(),t.stopPropagation()}})),{tag:"td",class:"d-flex align-items-center justify-content-around my-auto",children:[{class:s},a]}}class pt{constructor(e){this.appState=e,this.showSynced$=new o.BehaviorSubject(!1),this.showNext$=new o.BehaviorSubject(!1),this.options$=(0,o.combineLatest)([this.showSynced$,this.showNext$]).pipe((0,d.map)((([e,t])=>({showSynced:e,showNext:t})))),this.webSocket$=U.uploadPackages.connectWs(),this.syncQueued$=new o.BehaviorSubject(new Set),this.underSynchronization$=new o.BehaviorSubject(new Set),this.logsState=new ae(this.webSocket$.pipe((0,d.map)((e=>e))))}subscribe(){return U.uploadPackages.status$().subscribe(),[]}toggleSync(e,t){let s=e+"#"+t,a=this.syncQueued$.getValue();a.has(s)?a.delete(s):a.add(s),this.syncQueued$.next(a)}isToggled$(e,t){let s=e+"#"+t;return this.syncQueued$.pipe((0,d.map)((e=>e.has(s))))}synchronize(){let e={assetIds:Array.from(this.syncQueued$.getValue()).map((e=>({assetId:e.split("#")[0],version:e.split("#")[1]})))};U.uploadPackages.syncPackages$(e).subscribe()}}class ft{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new o.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.headerView(),this.contentView()]},new ie(e.logsState)],this.selected$.subscribe((e=>{console.log(e),this.state.appState.addTabUpload(e)}))}headerView(){let e=new ce.ExpandableGroup.State("options",!1),t=(e,t)=>{let s=new M.Switch.State(e);return{class:"d-flex align-items-center ",children:[{innerText:t,class:(0,l.attr$)(s.value$,(e=>e?"fv-text-focus":""),{wrapper:e=>e+" px-2"})},new M.Switch.View({state:s})]}};return new ce.ExpandableGroup.View({state:e,class:"mx-3 mb-3",headerView:ce.ExpandableGroup.defaultHeaderView,contentView:()=>({class:"d-flex w-100 justify-content-around align-items-center border rounded ",children:[t(this.state.showSynced$,"display synced items"),t(this.state.showNext$,"display '-next' items")]})})}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[(0,l.child$)((0,o.combineLatest)([U.uploadPackages.packages$,this.state.options$]),(([e,t])=>function(e,t,s,a){return{class:"h-100 d-flex flex-column",children:[{class:"overflow-auto fv-color-primary border",children:[{tag:"table",class:" w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-3"},{tag:"td",innerText:"CDN",class:"px-3"},{tag:"td",innerText:"Asset",class:"px-3"}]}]},{tag:"tbody",children:e.map((e=>{let a="fv-pointer fv-hover-bg-background-alt ";return e.status instanceof C&&!t.showSynced&&e.status.cdnStatus==c.SYNC&&e.status.treeStatus==c.SYNC&&(a+="d-none"),{tag:"tr",class:a,children:[{tag:"td",innerText:e.name,class:"px-3"},ut(e),ht(e)],onclick:()=>s.next(e)}}))}]}]}]}}(Object.values(e),t,this.selected$,this.state))),(0,l.child$)((0,o.combineLatest)([U.uploadPackages.packageVersions$,this.state.options$]),(([e,t])=>function(e,t,s){return{class:"d-flex flex-column border fv-color-primary",style:{height:"fit-content","max-height":"100%"},children:[{class:"overflow-auto",children:[dt(e,t,s)]},{class:"d-flex align-items-baseline",children:[(0,l.child$)(s.syncQueued$,(e=>function(e,t){let s={};if(0==e.size)s={innerText:"No items selected for synchronization",class:"fv-text-focus"};else{let a=q("fas fa-sync",`Sync. (${e.size})`);a.state.click$.subscribe((e=>t.synchronize())),s=a}return{class:"w-100",children:[{class:" border fv-color-primary"},{class:"m-3",children:[s]}]}}(e,s)))]}]}}(Object.values(e),t,this.state)))]}]}}}class gt{constructor(e){this.appState=e,this.webSocket$=U.uploadFluxApps.connectWs(),this.logsState=new ae(this.webSocket$.pipe((0,d.map)((e=>e))))}subscribe(){return[]}}class wt{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new o.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new ie(e.logsState)],this.selected$.subscribe((e=>{console.log(e),this.state.appState.addTabUpload(e)}))}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[bt(this.state)]}]}}}class xt extends te.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function bt(e){let t=new xt({rootNode:new je({id:"root",name:"groups",basePath:"/api/assets-gateway"}),status$:e.webSocket$.pipe((0,d.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Local workspace:"},new te.ImmutableTree.View({state:t,headerView:mt,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function mt(e,t){let s=[{target:e=>e instanceof Le.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof Le.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof Ge&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof je||e instanceof Ge&&!e.id.includes("private"),icon:"fas fa-users"}];return t instanceof Le.ModuleExplorer.FileNode&&t.file.metadata&&"flux-project"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>U.uploadFluxApps.publish$(t.id).subscribe(),class:"fas fa-cloud-upload-alt fv-hover-text-focus mx-2 fv-pointer"},(0,l.child$)(e.status$.pipe((0,d.filter)((e=>e.assetId==t.id))),(({status:e})=>e==i.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:Le.ModuleExplorer.headerView(e,t,s)}class $t{constructor(e){this.appState=e,this.webSocket$=U.uploadData.connectWs(),this.logsState=new ae(this.webSocket$.pipe((0,d.map)((e=>e))))}subscribe(){return[]}}class vt{constructor(e){this.tag="div",this.class="fv-text-primary h-100 d-flex flex-column h-100 fv-bg-background-alt",this.selected$=new o.ReplaySubject,this.state=e,this.children=[{class:"h-75 d-flex flex-column w-100 fv-bg-background py-3",children:[this.contentView()]},new ie(e.logsState)]}contentView(){return{class:"h-100 flex-grow-1",style:{"min-height":"0px"},children:[{class:"d-flex w-100 h-100 justify-content-around",children:[kt(this.state)]}]}}}class St extends te.ImmutableTree.State{constructor({rootNode:e,status$:t,expandedNodes:s}){super({rootNode:e,expandedNodes:s}),this.status$=t}}function kt(e){let t=new St({rootNode:new je({id:"root",name:"groups",basePath:"/api/assets-gateway"}),status$:e.webSocket$.pipe((0,d.filter)((e=>e.assetId&&e.status))),expandedNodes:["root"]});return{class:"d-flex h-100 flex-column",children:[{innerText:"Local workspace to import data:"},new te.ImmutableTree.View({state:t,headerView:Tt,class:"fv-bg-background fv-text-primary flex-grow-1 overflow-auto",style:{"min-height":"0"}})]}}function Tt(e,t){let s=[{target:e=>e instanceof Le.ModuleExplorer.FileNode&&"package"==e.file.metadata.kind,classes:"d-flex align-items-center fv-pointer",icon:"fas fa-cloud-download-alt"},{target:e=>e instanceof Le.ModuleExplorer.FileNode,classes:"d-flex align-items-center fv-pointer fv-text-disabled"},{target:e=>e instanceof Ge&&e.id.includes("private"),icon:"fas fa-user"},{target:e=>e instanceof je||e instanceof Ge&&!e.id.includes("private"),icon:"fas fa-users"}];return t instanceof Le.ModuleExplorer.FileNode&&t.file.metadata&&"data"==t.file.metadata.kind?{class:"d-flex align-items-center",children:[{innerText:t.name},{onclick:()=>U.uploadData.publish$(t.id).subscribe(),class:"fas fa-cloud-upload-alt fv-hover-text-focus mx-2 fv-pointer"},(0,l.child$)(e.status$.pipe((0,d.filter)((e=>e.assetId==t.id))),(({status:e})=>e==i.PROCESSING?{class:"fas fa-spinner fa-spin fv-text-focus"}:{}))]}:Le.ModuleExplorer.headerView(e,t,s)}class yt extends Ce.Tabs.TabData{constructor(e){super(we.AssetsUploadPackages,"Packages"),this.packagesState=e}view(){return new ft(this.packagesState)}}class Nt extends Ce.Tabs.TabData{constructor(e,t){super(e.name,e.name),this.library=e,this.packagesState=t}view(){return e=this.library,t=this.packagesState,{class:"h-100 d-flex flex-column w-100 fv-bg-background-alt fv-color-primary",children:[{class:"h-100 d-flex flex-column fv-bg-background p-3  overflow-auto",children:[nt(e),{tag:"hr",class:"w-100 fv-color-primary"},tt(e),st(e)]},new ie(t.logsState)]};var e,t}}class Et extends Ce.Tabs.TabData{constructor(e){super(we.AssetsUploadFluxApps,"Flux Apps"),this.state=e}view(){return new wt(this.state)}}class Dt extends Ce.Tabs.TabData{constructor(e){super(we.AssetsUploadData,"Data"),this.state=e}view(){return new vt(this.state)}}class Rt{constructor(e){this.selectedPanel$=e,this.selectedTab$=new o.BehaviorSubject("packages"),this.packagesState=new pt(this),this.fluxAppsState=new gt(this),this.dataAssetState=new $t(this),e.subscribe((e=>{this.selectedTab$.next(e)})),this.tabsData$=new o.BehaviorSubject([new yt(this.packagesState),new Et(this.fluxAppsState),new Dt(this.dataAssetState)])}addTabUpload(e){this.tabsData$.getValue().find((t=>t instanceof Nt&&t.id==e.name))||(this.tabsData$.next([...this.tabsData$.getValue(),new Nt(e,this.packagesState)]),this.selectedTab$.next(e.name))}removeTabUpload(e){this.selectedTab$.getValue()==e&&this.selectedTab$.next(this.tabsData$.getValue()[0].id),this.tabsData$.next(this.tabsData$.getValue().filter((t=>t.name!=e)))}}class It extends Ce.Tabs.State{constructor(e){super(e.tabsData$,e.selectedTab$),this.assetsState=e}}class Pt{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=new It(e);this.children=[new Ce.Tabs.View({class:"d-flex flex-column h-100",state:t,headerView:Ot,contentView:(e,t)=>t.view()})],this.connectedCallback=t=>{t.ownSubscriptions(...e.packagesState.subscribe())}}}function Ot(e,t){return t instanceof yt||t instanceof Et||t instanceof Dt?{innerText:t.name,class:"px-2"}:t instanceof Nt?{class:"d-flex align-items-center px-2",children:[{innerText:t.name,class:"px-2"},{class:"fas fa-times fv-pointer p-1 ",onclick:s=>{e.assetsState.removeTabUpload(t.name),s.stopPropagation()}}]}:void 0}class Vt{constructor(){}}class At{constructor(){this.tag="div",this.class=_;let e=new ae(Ee.webSocket$);this.children=[{class:"d-flex flex-column flex-grow-1 w-100 overflow-auto",style:{height:"0"},children:[W({innerHTML:"This is a readonly preview of your current configuration file.\nYou can get arguments completion, type checkings, and more when editing this file with <a href='https://www.jetbrains.com/fr-fr/pycharm/'>pycharm</a> and the plugin <a href='https://pydantic-docs.helpmanual.io/pycharm_plugin/'> pydantic </a>."}),(0,l.child$)(U.environment.fileContent$(),(({content:e})=>({id:"codeMirror",class:"flex-grow-1 w-100 py-1",style:{height:"0"},connectedCallback:t=>{let s=document.getElementById("codeMirror"),a={value:e,mode:"python",theme:"blackboard",lineNumbers:!0};window.CodeMirror(s,a).setSize("100%","100%")}})))]},new ie(e)],this.connectedCallback=e=>{}}}let Ct={[we.ConfigurationGeneral]:"General",[we.ConfigurationRawFile]:"Raw file"};class Bt{constructor(e){this.selectedPanel$=e,this.logMessages$=new o.Subject,this.generalState=new Ee,this.packageState=new Vt}}class Lt extends Ce.Tabs.TabData{constructor(e){super(we.ConfigurationGeneral,Ct[we.ConfigurationGeneral]),this.generalState=e}view(){return new De(this.generalState)}}class jt extends Ce.Tabs.TabData{constructor(e){super(we.ConfigurationRawFile,Ct[we.ConfigurationRawFile]),this.generalState=e}view(){return new At}}class Gt{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1 w-25";let t=[new Lt(e.generalState),new jt(e.generalState)];this.children=[new Ce.Tabs.View({class:"d-flex flex-column h-100",state:new Ce.Tabs.State(t,e.selectedPanel$),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}class Ft extends xe.Select.ItemData{constructor(e){super(e.name,e.name),this.data=e}}function Ut(e,t,s){let a=t.map((e=>new Ft(e))),n=new xe.Select.State(a,a[0].id),r=new ce.Modal.State,i=q("","Create"),c=new o.ReplaySubject(1),u=new ce.Modal.View({state:r,contentView:()=>({class:"fv-text-primary fv-bg-background-alt p-4 rounded border fv-color-primary",style:{"max-width":"75%"},children:[{class:"d-flex align-items-baseline py-2 text-center mx-auto justify-content-center",children:[{tag:"h3",class:"text-center fv-text-focus",innerText:e},new xe.Select.View({state:n,class:"mx-2",style:{"font-size":"x-large"}})]},(0,l.child$)(n.selection$,(e=>function(e,t){let s=e.data.parameters.map((e=>{let t=new o.ReplaySubject(1);return null!=e.defaultValue&&t.next({id:e.id,value:e.defaultValue}),t}));return{children:[(a=e.data.description,{children:[{tag:"hr",class:"fv-color-primary"},{class:"d-flex align-items-center",children:[{tag:"i",class:"fas fa-info-circle fa-2x px-3"},{tag:"div",innerHTML:a}]},{tag:"hr",class:"fv-color-primary"}]}),{children:e.data.parameters.map(((e,t)=>function(e,t){let s=new o.BehaviorSubject(!1),a={string:{class:"ml-2",tag:"input",placeholder:e.placeholder,oninput:s=>t.next({id:e.id,value:s.target.value})},text:{tag:"textarea",class:"ml-2 w-100 flex-grow-1",placeholder:e.placeholder,oninput:s=>t.next({id:e.id,value:s.target.value})}};return{children:[{class:"d-flex align-items-center my-3",children:[{class:e.required?"fv-text-focus":"",innerText:e.displayName},{class:"fv-text-focus",innerText:e.required?"*":""},{class:(0,l.attr$)(s,(e=>e?"fv-text-focus":""),{wrapper:e=>"i fas fa-info fv-pointer mx-2 fv-hover-text-focus "+e}),onclick:()=>s.next(!s.getValue())},{...a[e.type],...e.defaultValue?{value:e.defaultValue}:{}}]},{class:(0,l.attr$)(s,(e=>e?"d-block":"d-none")),innerText:e.description}]}}(e,s[t])))}],connectedCallback:e=>{0!=s.length?e.subscriptions.push((0,o.combineLatest)(s).pipe((0,d.map)((e=>e.reduce(((e,t)=>({...e,[t.id]:t.value})),{})))).subscribe((e=>{t.next(e)}))):t.next({parameters:{}})}};var a}(e,c))),{tag:"hr",class:"fv-color-primary"},(0,l.child$)(c,(e=>i))]})}),h=(0,l.render)(u);document.body.appendChild(h),r.cancel$.subscribe((()=>h.remove())),i.state.click$.pipe((0,d.mergeMap)((()=>c)),(0,d.mergeMap)((e=>s.createSkeleton$(n.selectionId$.getValue(),{parameters:e})))).subscribe((e=>{h.remove()}))}class Mt{constructor(){this.status$=new o.ReplaySubject(1),this.webSocket$=U.fronts.connectWs()}subscribe(){return[this.webSocket$.pipe((0,d.filter)((({type:e})=>"Status"==e))).subscribe((({status:e})=>{this.status$.next(e)})),(0,o.combineLatest)([this.webSocket$.pipe((0,d.take)(1)),Ee.configurationUpdated$]).pipe((0,d.mergeMap)((()=>U.fronts.status$()))).subscribe((e=>{this.status$.next(e.status)}))]}}class _t{constructor(e){this.tag="div",this.class=_,this.state=e;let t=new ae(this.state.webSocket$);this.children=[{tag:"h3",class:"d-flex",children:[(0,l.child$)(e.status$,(()=>({children:[this.newFrontBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,l.child$)(e.status$,(e=>this.contentView(e))),new ie(t)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}newFrontBttn(){let e=q("fas fa-plus","new front-end");return e.state.click$.pipe((0,d.mergeMap)((()=>U.fronts.skeletons$()))).subscribe((({skeletons:e})=>{Ut("New frontend",e,U.fronts)})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.tableView(e)]}}tableView(e){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"url"},{tag:"td",innerText:"Dev server"},{tag:"td",innerText:"Health"}]}]},{tag:"tbody",children:e.map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt",children:[(t=e,{tag:"td",innerText:t.name,style:{"font-family":"cursive","font-size":"large"}}),qt(e),Yt(this.state,e),Wt(e)]};var t}))}]}}}function qt(e){return{tag:"td",children:[{tag:"a",href:e.url,innerText:e.url}]}}function Wt(e){return{tag:"td",class:e?"fv-text-success":"fv-text-error",children:[{tag:"i",class:e?"fas fa-check px-2":"fas fa-times px-2",onclick}]}}function Yt(e,t){if(null==t.devServer)return{};let s=e.webSocket$.pipe((0,d.filter)((e=>e.target==t.name&&e.action==Y.SERVE)),(0,d.filter)((({step:e})=>[J.STARTED,J.DONE].includes(e)))),a=new o.ReplaySubject;return s.subscribe((e=>{a.next(e)})),a.next(t.devServer?{step:J.STARTED}:{step:J.DONE}),{tag:"td",children:[{children:[(0,l.child$)(a,(({step:e})=>({tag:"i",class:"fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus"+(e==J.STARTED?" fas fa-stop ":" fas fa-play "),onclick:()=>e==J.STARTED?U.fronts.stop$(t.name).subscribe((()=>{})):U.fronts.start$(t.name).subscribe((()=>{}))})))]}]}}class Ht{constructor(){this.highlighted$=new o.ReplaySubject(1),this.autoWatched$=new o.BehaviorSubject([]),this.dependenciesRequest$=new o.Subject,this.webSocket$=U.modules.connectWs()}subscribe(){return[(0,o.combineLatest)([this.webSocket$.pipe((0,d.take)(1)),Ee.configurationUpdated$]).pipe((0,d.mergeMap)((()=>U.modules.status$()))).subscribe((e=>{Ht.status$.next(e)})),this.dependenciesRequest$.pipe((0,d.debounceTime)(250),(0,d.switchMap)((({assetId:e,direction:t})=>U.modules.dependencies$(e).pipe((0,d.map)((e=>({deps:e,direction:t}))))))).subscribe((({deps:e,direction:t})=>{"up"==t?this.highlighted$.next(e.belowDependencies):this.highlighted$.next(e.aboveDependencies)}))]}toggleWatch(e){let t=this.autoWatched$.getValue();t=t.includes(e)?t.filter((t=>t!=e)):t.concat([e]),this.autoWatched$.next(t),U.modules.watch$({libraries:t}).subscribe()}}Ht.status$=new o.ReplaySubject(1);class zt{constructor(e){this.tag="div",this.class=_,this.state=e;let t=new ae(this.state.webSocket$.pipe((0,d.map)((e=>e))));this.children=[{tag:"h3",class:"d-flex",children:[(0,l.child$)(Ht.status$,(()=>({children:[this.syncAllBttn(),this.newPackageBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,l.child$)(Ht.status$.pipe((0,d.map)((e=>e.status))),(e=>this.contentView(e))),new ie(t)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}syncAllBttn(){let e=q("fas fa-sync","Sync. all");return e.state.click$.pipe((0,d.mergeMap)((()=>U.modules.action$({action:"SYNC",targetName:"",scope:"ALL"})))).subscribe((e=>{Ht.status$.next(e)})),e}newPackageBttn(){let e=q("fas fa-plus","new package");return e.state.click$.pipe((0,d.mergeMap)((()=>U.modules.skeletons$()))).subscribe((({skeletons:e})=>{Ut("New package",e,U.modules)})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.installQueueView(e),this.pipelinesTableView(e)]}}installQueueView(e){return 0==e.filter((e=>"NOT_INSTALLED"==e.installStatus)).length?{}:{class:"overflow-auto",children:[{tag:"h3",innerText:"List of packages to install"},W({innerText:"Following packages have not been installed yet. \n                    Installation step usually install required dependencies and initialize the asset properly. \n                    Internet connection is usually required here."}),{tag:"table",class:"fv-color-primary mx-auto text-center my-2",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:e.filter((e=>"NOT_INSTALLED"==e.installStatus)).map((e=>({tag:"tr",children:[Kt(e),Zt(this.state,e)]})))}]}]}}pipelinesTableView(e){return e.filter((e=>"INSTALLED"==e.installStatus)),{class:"overflow-auto",children:[{tag:"h3",innerText:"Pipelines status"},{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:"Version"},{tag:"td",innerText:"Watch"},{tag:"td",innerText:"Actions"},{tag:"td",innerText:"Build Status"},{tag:"td",innerText:"Test Status"},{tag:"td",innerText:"CDN Status"}]}]},{tag:"tbody",children:e.filter((e=>"INSTALLED"==e.installStatus)).map((e=>({tag:"tr",class:(0,l.attr$)(this.state.highlighted$,(t=>t.includes(e.name)?"fv-bg-background-alt":""),{wrapper:e=>e+" fv-hover-bg-background-alt",untilFirst:"fv-hover-bg-background-alt"}),children:[Kt(e),Xt(e),es(this.state,e),ts(this.state,e),ns(this.state,e),rs(this.state,e),is(this.state,e)]})))}]}]}}}let Jt="fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus",Qt={NEVER_BUILT:{color:"fv-text-focus ",icon:"fas fa-sync "+Jt,text:"never built"},NOT_PUBLISHED:{color:"fv-text-focus ",icon:"fas fa-sync "+Jt,text:""},GREEN:{color:"fv-text-success ",icon:"fas fa-check ",text:""},RED:{color:"fv-text-error ",icon:"fas fa-sync "+Jt,text:""},CDN_ERROR:{color:"fv-text-error ",icon:"fas fa-times ",text:""},OUT_OF_DATE:{color:"fv-text-focus ",icon:"fas fa-sync "+Jt,text:""},INDIRECT_OUT_OF_DATE:{color:"fv-text-focus ",icon:"fas fa-sync "+Jt,text:"(indirect)"},NO_ENTRY:{color:"fv-text-focus ",icon:"fas fa-sync "+Jt,text:""},SYNC:{color:"fv-text-success ",icon:"fas fa-check "+Jt,text:""}};function Kt(e){return e.documentation?{tag:"td",style:{"font-family":"cursive","font-size":"large"},children:[{tag:"a",href:e.documentation,innerText:e.name}]}:{tag:"td",innerText:e.name,style:{"font-family":"cursive","font-size":"large"}}}function Xt(e){return{tag:"td",innerText:e.version}}function Zt(e,t){let s=e.webSocket$.pipe((0,d.filter)((e=>e.target==t.name&&e.action==Y.INSTALL))),a=q("","Install");return a.state.click$.pipe((0,d.mergeMap)((()=>U.modules.install$(t.assetId)))).subscribe((()=>console.log("install done"))),{class:"d-flex align-items-center",children:[(0,l.child$)(a.state.click$,(()=>({})),{untilFirst:a}),{tag:"i",class:(0,l.attr$)(s.pipe((0,d.filter)((({step:e})=>[J.STARTED,J.DONE].includes(e)))),(e=>e.step==J.STARTED?"fas fa-spinner fa-spin p-3":""))}]}}function es(e,t){return{tag:"td",class:(0,l.attr$)(e.autoWatched$,(e=>e.includes(t.name)?"fas fa-satellite-dish fv-text-focus ":"fas fa-satellite-dish "),{wrapper:e=>e+Jt}),onclick:()=>e.toggleWatch(t.name)}}function ts(e,t){return{tag:"td",children:[{tag:"i",class:"far fa-arrow-alt-circle-right "+Jt,onclick:()=>ss(0,{action:Y.SYNC,targetName:t.name,scope:H.TARGET_ONLY})},{tag:"i",class:"far fa-arrow-alt-circle-up "+Jt,onclick:()=>ss(0,{action:Y.SYNC,targetName:t.name,scope:H.ALL_ABOVE}),onmouseover:()=>{e.dependenciesRequest$.next({assetId:t.assetId,direction:"up"})},onmouseout:()=>e.highlighted$.next([])},{tag:"i",class:"far fa-arrow-alt-circle-down "+Jt,onclick:()=>ss(0,{action:Y.SYNC,targetName:t.name,scope:H.ALL_BELOW}),onmouseover:s=>{e.dependenciesRequest$.next({assetId:t.assetId,direction:"down"})},onmouseout:()=>e.highlighted$.next([])}]}}function ss(e,t){U.modules.action$(t).subscribe((e=>{}))}function as(e,t,s){let a=e.webSocket$.pipe((0,d.filter)((e=>e.target==t&&e.action==s))),n=new o.ReplaySubject;return{tag:"td",class:(0,l.attr$)(n,(({color:e})=>e)),children:[{tag:"i",innerText:(0,l.attr$)(n,(({text:e})=>e))},{tag:"i",class:(0,l.attr$)(n,(({icon:e})=>e)),onclick:()=>ss(0,{action:s,targetName:t,scope:H.TARGET_ONLY})},{tag:"i",class:(0,l.attr$)(a.pipe((0,d.filter)((({step:e})=>[J.STARTED,J.DONE].includes(e)))),(e=>e.step==J.STARTED?"fas fa-spinner fa-spin":""))}],connectedCallback:e=>{e.subscriptions.push(a.pipe((0,d.filter)((({step:e,content:t})=>e==J.STATUS&&null!=Qt[t])),(0,d.map)((({content:e})=>Qt[e]))).subscribe((e=>{n.next(e)})))}}}function ns(e,t){return as(e,t.name,Y.BUILD)}function rs(e,t){return as(e,t.name,Y.TEST)}function is(e,t){return as(e,t.name,Y.CDN)}function cs(e,t,s){let a=e.pipe((0,d.filter)((e=>e.target==t.name&&e.action==Y.INSTALL))),n=q("","Install");return n.state.click$.pipe((0,d.mergeMap)((()=>s.install$(t.assetId)))).subscribe((()=>console.log("install done"))),{class:"d-flex align-items-center",children:[(0,l.child$)(n.state.click$,(()=>({})),{untilFirst:n}),{tag:"i",class:(0,l.attr$)(a.pipe((0,d.filter)((({step:e})=>[J.STARTED,J.DONE].includes(e)))),(e=>e.step==J.STARTED?"fas fa-spinner fa-spin p-3":""))}]}}class ls{constructor(){this.status$=new o.ReplaySubject(1),this.environments$=new o.BehaviorSubject([]),this.currentEnvironment$=new o.BehaviorSubject(""),this.selectedEnvId$=new o.BehaviorSubject(""),this.envSelectionState=new xe.Select.State(this.environments$,this.selectedEnvId$),this.selectedUserId$=new o.BehaviorSubject(localStorage.getItem("user-name")||"greinisch@youwol.com"),this.webSocket$=U.backs.connectWs()}subscribe(){return[this.webSocket$.pipe((0,d.filter)((({type:e})=>"Status"==e))).subscribe((({status:e})=>{this.status$.next(e)})),(0,o.combineLatest)([this.webSocket$.pipe((0,d.take)(1)),Ee.configurationUpdated$]).pipe((0,d.mergeMap)((()=>U.backs.status$()))).subscribe((e=>{this.status$.next(e.status)}))]}}class os{constructor(e){this.tag="div",this.class=_,this.state=e;let t=new ae(this.state.webSocket$);this.children=[{tag:"h3",class:"d-flex",children:[this.newBackBttn(),(0,l.child$)(e.status$,(()=>({children:[this.startBttn(),this.restartBttn()]})),{untilFirst:{class:"px-2 fas fa-spinner fa-spin"}})]},(0,l.child$)(e.status$,(e=>{return t=this.state.webSocket$,s=e,"",a=U.backs,0==s.filter((e=>"NOT_INSTALLED"==e.installStatus)).length?{}:{class:"overflow-auto",children:[{tag:"h4",innerText:"Assets to install"},W({innerText:""}),{tag:"table",class:"fv-color-primary mx-auto text-center my-2",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""}]}]},{tag:"tbody",children:s.filter((e=>"NOT_INSTALLED"==e.installStatus)).map((e=>({tag:"tr",children:[{tag:"td",innerText:e.name,style:{"font-family":"cursive","font-size":"large"}},cs(t,e,a)]})))}]}]};var t,s,a})),(0,l.child$)(e.status$,(e=>this.contentView(e))),new ie(t)],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}newBackBttn(){let e=q("fas fa-plus","new backend-end");return e.state.click$.pipe((0,d.mergeMap)((()=>U.backs.skeletons$()))).subscribe((({skeletons:e})=>{Ut("New backend",e,U.backs)})),e}startBttn(){let e=q("fas fa-play","Start");return e.state.click$.pipe((0,d.mergeMap)((()=>U.backs.start$()))).subscribe((()=>{})),e}restartBttn(){let e=q("fas fa-play","Re-start");return e.state.click$.pipe((0,d.mergeMap)((()=>U.backs.restart$()))).subscribe((()=>{})),e}contentView(e){return{class:"flex-grow-1 h-25 overflow-auto",children:[this.tableView(e)]}}tableView(e){return{tag:"table",class:"fv-color-primary  w-100 text-center",children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name"},{tag:"td",innerText:""},{tag:"td",innerText:"Actions"},{tag:"td",innerText:"Health"}]}]},{tag:"tbody",children:e.filter((e=>"INSTALLED"==e.installStatus)).map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt",children:[us(this.state,e),hs(this.state,e),ps(this.state,e),(t=this.state,s=e,function(e,t,s){let a=e.webSocket$.pipe((0,d.filter)((e=>e.target==t.name&&"serve"==e.action)),(0,d.filter)((e=>["started","serving","done"].includes(e.step)))),n=new o.BehaviorSubject(t.health?s.serving:s.error);return{tag:"td",children:[(0,l.child$)(n,(e=>({tag:"i",class:e.class,onclick:e.onclick?e.onclick:()=>{}})))],connectedCallback:e=>{e.subscriptions.push(a.pipe((0,d.map)((e=>s[e.step]))).subscribe((e=>n.next(e))))}}}(t,s,{started:{class:"fas fa-spinner fa-spin fv-text-primary",onclick:void 0},serving:{class:"fv-text-success fas fa-check px-2",onclick:void 0},error:{class:"fv-text-error fas fa-times px-2",onclick:void 0},done:{class:"fv-text-error fas fa-times px-2",onclick:void 0}}))]};var t,s}))}]}}}let ds="fv-pointer p-2 fv-hover-bg-primary fv-hover-text-focus";function us(e,t){return{tag:"td",innerText:t.name,style:{"font-family":"cursive","font-size":"large"}}}function hs(e,t){return t.openApi?{tag:"td",innerHTML:`<a href='${t.openApi}'> doc </a> `}:{tag:"td"}}function ps(e,t){return{tag:"td",children:[{tag:"i",class:t.devServer?`fas fa-stop fv-text-primary ${ds}`:`fas fa-play fv-text-primary ${ds}`,onclick:()=>{t.devServer?U.backs.stop$(t.assetId).subscribe():U.backs.start$(t.assetId).subscribe()}}]}}class fs{constructor(){this.packagesStatus$=U.localCdnPackages.packagesStatus$,this.packageDetails$=U.localCdnPackages.packageDetails$,this.selectedPackageVersion$=new o.BehaviorSubject(void 0),this.webSocket$=U.localCdnPackages.connectWs()}subscribe(){let e=this.packagesStatus$.subscribe((e=>console.log("packagesStatus",e))),t=this.packageDetails$.subscribe((e=>console.log("packageDetails",e)));return U.localCdnPackages.status$().subscribe(),[e,t]}getPackageDetails(e){U.localCdnPackages.getPackageDetails$(e).subscribe()}selectPackageVersion(e){this.selectedPackageVersion$.next(e)}}class gs{constructor(e){this.tag="div",this.class=_,this.state=e,this.children=[{class:"d-flex h-100 justify-content-around",children:[(0,l.child$)(this.state.packagesStatus$,(e=>this.packagesTable(e))),{class:"d-flex flex-column h-100 px-2",style:{maxWidth:"50%"},children:[(0,l.child$)(this.state.packageDetails$,(e=>e?this.packageDetails(e):{})),(0,l.child$)(this.state.selectedPackageVersion$,(e=>e?this.packageBrowserView(e):{}))]}]}],this.connectedCallback=e=>{e.ownSubscriptions(...this.state.subscribe())}}packagesTable(e){return{class:"overflow-auto h-100",children:[{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Name",class:"px-2"},{tag:"td",innerText:"Version count",class:"px-2"},{tag:"td",innerText:"Latest version",class:"px-2"},{tag:"td",innerText:"",class:"px-2"}]}]},{tag:"tbody",children:e.packages.map((e=>{return{tag:"tr",class:"fv-hover-bg-background-alt fv-pointer",children:[ws(e),xs(e),bs(e),(t=e.name,{tag:"td",children:[{class:"fas fa-trash fv-text-error px-2 fv-pointer",onclick:()=>{confirm(`Are you sure you want to remove ${t} (all versions) from local CDN`)&&U.localCdnPackages.deletePackage$(t).subscribe()}}]})],onclick:()=>{this.state.getPackageDetails(e.name),this.state.selectPackageVersion(void 0)}};var t}))}]}]}}packageDetails(e){return{class:"overflow-auto",style:{maxHeight:"50%"},children:[{tag:"h4",class:"fv-text-focus",innerText:e.name},{tag:"table",class:"fv-color-primary  w-100 text-center",style:{"max-height":"100%"},children:[{tag:"thead",children:[{tag:"tr",class:"fv-bg-background-alt",children:[{tag:"td",innerText:"Version",class:"px-2"},{tag:"td",innerText:"files count",class:"px-2"},{tag:"td",innerText:"bundle size (Ko)",class:"px-2"},{tag:"td",innerText:"",class:"px-2"}]}]},{tag:"tbody",children:e.versions.map((t=>{return{tag:"tr",class:"fv-hover-bg-background-alt",onclick:()=>this.state.selectPackageVersion(t),children:[{tag:"td",innerText:t.version,class:"px-2"},{tag:"td",innerText:t.filesCount,class:"px-2"},{tag:"td",innerText:Math.floor(t.bundleSize/100)/10,class:"px-2"},(s=e.name,a=t.version,{tag:"td",children:[{class:"fas fa-trash fv-text-error px-2 fv-pointer",onclick:()=>{confirm(`Are you sure you want to remove ${s}@${a} from local CDN`)&&U.localCdnPackages.deleteVersion$(s,a).subscribe()}}]})]};var s,a}))}]}]}}packageBrowserView(e){let t=""==e.namespace?`/libraries/${e.name}`:`/libraries/${e.namespace}/${e.name}`,s=e.path.join("/").split(t)[0].split("/").length-2;return{class:"w-100 py-2 flex-grow-1",children:[{tag:"h4",class:"fv-text-focus",innerText:"Browser"},le({startingFolder:e.path,originFolderIndex:s})]}}}function ws(e){return{tag:"td",innerText:e.name,class:"px-2"}}function xs(e){return{tag:"td",innerText:e.versions.length,class:"px-2"}}function bs(e){return{tag:"td",innerText:e.versions[0].version,class:"px-2"}}let ms={[we.LocalEnvPackage]:"Packages",[we.LocalEnvFronts]:"Front Ends",[we.LocalEnvBacks]:"Back Ends",[we.LocalEnvCDN]:"CDN"};class $s{constructor(e){this.selectedPanel$=e,this.logMessages$=new o.Subject,this.modulesState=new Ht,this.frontendsState=new Mt,this.backendsState=new ls,this.cdnState=new fs}}class vs extends Ce.Tabs.TabData{constructor(e){super(we.LocalEnvPackage,ms[we.LocalEnvPackage]),this.modulesState=e}view(){return new zt(this.modulesState)}}class Ss extends Ce.Tabs.TabData{constructor(e){super(we.LocalEnvFronts,ms[we.LocalEnvFronts]),this.frontEndsState=e}view(){return new _t(this.frontEndsState)}}class ks extends Ce.Tabs.TabData{constructor(e){super(we.LocalEnvBacks,ms[we.LocalEnvBacks]),this.backendsState=e}view(){return new os(this.backendsState)}}class Ts extends Ce.Tabs.TabData{constructor(e){super(we.LocalEnvCDN,ms[we.LocalEnvCDN]),this.cdnState=e}view(){return new gs(this.cdnState)}}class ys{constructor(e){this.tag="div",this.class="p-2 h-100 flex-grow-1";let t=[new vs(e.modulesState),new Ss(e.frontendsState),new ks(e.backendsState),new Ts(e.cdnState)];this.children=[new Ce.Tabs.View({class:"d-flex flex-column h-100",state:new Ce.Tabs.State(t,e.selectedPanel$),headerView:(e,t)=>({innerText:t.name,class:"px-2"}),contentView:(e,t)=>t.view()})]}}s(897);let Ns=new class{constructor(){this.environmentChildren$=new o.BehaviorSubject([we.ConfigurationGeneral,we.ConfigurationRawFile]),this.localChildren$=new o.BehaviorSubject([we.LocalEnvPackage,we.LocalEnvFronts,we.LocalEnvBacks,we.LocalEnvCDN]),this.uploadChildren$=new o.BehaviorSubject([we.AssetsUploadPackages,we.AssetsUploadFluxApps,we.AssetsUploadData]),this.downloadChildren$=new o.BehaviorSubject([we.AssetsDownloadPackages,we.AssetsDownloadFluxApps]),this.selected$=new o.BehaviorSubject(we.ConfigurationGeneral),this.localState=new $s(this.selected$),this.assetsUploadState=new Rt(this.selected$),this.assetsDownloadState=new Xe(this.selected$),this.configurationState=new Bt(this.selected$),this.panelViewFactory$=this.selected$.pipe((0,d.map)((e=>[we.LocalEnvPackage,we.LocalEnvFronts,we.LocalEnvBacks,we.LocalEnvCDN].includes(e)?new ys(this.localState):[we.AssetsUploadPackages,we.AssetsUploadFluxApps,we.AssetsUploadData].includes(e)?new Pt(this.assetsUploadState):[we.ConfigurationGeneral,we.ConfigurationRawFile].includes(e)?new Gt(this.configurationState):[we.AssetsDownloadPackages,we.AssetsDownloadFluxApps].includes(e)?new Ze(this.assetsDownloadState):void 0)))}addTabUpload(e){let t=this.uploadChildren$.getValue();Re[we.AssetsUploadPackage]={title:e,enabled:!0},this.uploadChildren$.next([...t,we.AssetsUploadPackage])}},Es={class:"d-flex fv-text-primary h-100",children:[new class{constructor(e){this.state=e,this.tag="div",this.class="d-flex justify-content-center py-5 px-2 border h-100 ",this.style={"min-width":"300px"},this.children=[{class:"h-100 mx-auto d-flex flex-column pl-3",children:[{tag:"a",href:"/ui/workspace-explorer",class:"w-100 mb-2 d-flex justify-content-center",children:[{tag:"img",class:"mx-auto text-center fv-pointer",style:{width:"75%"},href:"/ui/workspace-explorer",src:"/api/assets-gateway/raw/package/QHlvdXdvbC9mbHV4LXlvdXdvbC1lc3NlbnRpYWxz/latest/assets/images/logo_YouWol_Platform_white.png"}]},(0,l.child$)(U.environment.environments$,(e=>{return{class:"mb-5",children:[{class:"d-flex align-items-center fv-hover-text-focus fv-pointer  justify-content-center",onclick:()=>$e(),children:[{class:"fas fa-user"},{class:"fv-hover-text-focus fv-pointer mx-2",innerText:(t=e).userInfo.email}]},{class:"d-flex align-items-center justify-content-center",children:[{class:"fas fa-wifi px-2 "+(t.remoteGatewayInfo.connected?"fv-text-success":"fv-text-error")},{innerText:t.remoteGatewayInfo.host}]}]};var t})),Oe("Environment","fas fa-users-cog my-2",this.state.environmentChildren$,this.state.selected$),Oe("My computer","fas fa-laptop-code my-2",this.state.localChildren$,this.state.selected$),Oe("Upload assets","fas fa-cloud-upload-alt my-2",this.state.uploadChildren$,this.state.selected$),Oe("Download assets","fas fa-cloud-download-alt my-2",this.state.downloadChildren$,this.state.selected$),{class:"my-2 ",children:[Ie("Resources","fas fa-book",new o.BehaviorSubject(!1)),(0,l.child$)(Ee.environment$,(e=>({tag:"ul",class:"d-flex flex-column",children:Object.entries(e.configuration.general.resources).map((([e,t])=>({tag:"li",children:[{tag:"a",href:t,innerText:e}]})))})))]}]}]}}(Ns),(0,l.child$)(Ns.panelViewFactory$,(e=>e))]},Ds=U.system.connectWs();Ds.pipe((0,d.filter)((e=>"SystemError"==e.type))).subscribe((e=>{let t=new Ve(e),s=new ce.Modal.View({state:t,contentView:Ae}),a=(0,l.render)(s);document.querySelector("body").appendChild(a),t.ok$.subscribe((()=>a.remove())),t.cancel$.subscribe((()=>a.remove()))})),Ds.pipe((0,d.take)(1)).subscribe((e=>{document.body.appendChild((0,l.render)(Es))}))}}]);
//# sourceMappingURL=240.d196a4ae5f9fffa9b9e5.js.map